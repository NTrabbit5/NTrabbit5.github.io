<!DOCTYPE html>


<html lang="zh-CN">
  

    <head>
      <meta charset="utf-8" />
        
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title>20230521-AutoHotKey使用教程和脚本推荐 |  TeX_baitu blog</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      
<link rel="stylesheet" href="/css/fonts/remixicon.css">

      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    </head>
  </html>
</html>


<body>
  <div id="app">
    
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-20230521-AutoHotKey使用教程和脚本推荐"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  20230521-AutoHotKey使用教程和脚本推荐
</h1>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/05/21/20230521-AutoHotKey%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B%E5%92%8C%E8%84%9A%E6%9C%AC%E6%8E%A8%E8%8D%90/" class="article-date">
  <time datetime="2023-05-21T03:22:24.000Z" itemprop="datePublished">2023-05-21</time>
</a>   
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> 字数统计:</span>
            <span class="post-count">11.6k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> 阅读时长≈</span>
            <span class="post-count">43 分钟</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <p><a target="_blank" rel="noopener" href="https://www.autohotkey.com/">https://www.autohotkey.com/</a></p>
<p>windows自动化效率神奇，autohotkey 使用教程和脚本推荐</p>
<p>autohotkey 是一款windows 平台下的热键脚本语言程序，可以实现诸如窗口置顶，快速输入、快捷操作等丰富多彩的功能</p>
<p>能够通过自定义脚本实现很多快捷、自动化操作，乃至创建图形界面程序，而且占用资源极小，是一个能够高度自定义，可用性极高的工具</p>
<p>这里就介绍下如何通过autohotkey 来提高我的操作效率</p>
<p>autohotkey 使用方法</p>
<p>下载并解压 autohotkey 绿色版，绿色版，将脚本文本拖动到上面即可启用脚本</p>
<p>使用示例，新建文本文件，编写脚本如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">;这里的 “分号” 表示注释</span><br><span class="line">;快捷键 alt + n 打开记事本</span><br><span class="line">!n::Run notepad</span><br><span class="line"></span><br><span class="line">;快捷键 alt + y 打开百度云管家</span><br><span class="line">!y::Run H:\GanJingYunV2\BaiduYunGuanjia.exe</span><br></pre></td></tr></table></figure>

<p>保存为test.ank 脚本后缀名都为 .ank</p>
<p>右键选择 打开方式，浏览计算机中的程序，定位到autohotkey 软件所在目录中，选择autohotkeyU64.exe 确定</p>
<p>以后双击脚本，即可运行，这时就可以通过快捷键 alt+n 启动记事本，通过 alt+y 启动百度云管家了</p>
<h2 id="自制快捷启动器"><a href="#自制快捷启动器" class="headerlink" title="自制快捷启动器"></a>自制快捷启动器</h2><p>下面带大家开始写一个快捷启动脚本，很简单，这里分成3部分来说</p>
<p>热键标记</p>
<p>! 是热键标记，这里的感叹号代表键盘上的alt 键<br>!n 即对应键盘热键alt+n</p>
<p>常用热键标记对应关系</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># win 键</span><br><span class="line">! alt</span><br><span class="line">^ ctrl</span><br><span class="line">+ shift</span><br></pre></td></tr></table></figure>

<h2 id="2-连接"><a href="#2-连接" class="headerlink" title="2. 连接"></a>2. 连接</h2><p>符号:: 意味着每次按下前面的热键时，随后的命令将会被执行，这里用来连接热键标记和run 命令</p>
<h2 id="3-Run-命令"><a href="#3-Run-命令" class="headerlink" title="3. Run 命令"></a>3. Run 命令</h2><p>run 命令：用来启动一个程序，文档、url 网址或者快捷方式，如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Run Notepad</span><br><span class="line">Run C:\My Documents\Address List.doc</span><br><span class="line">Run www.yahoo.com</span><br><span class="line">Run mailto:someone@somedomain.com</span><br></pre></td></tr></table></figure>

<p>把上面3部分组合起来即可实现自定义快捷键</p>
<p>比如我想通过按Ctrl+q启动位于 <code>D:\software\QQ.exe</code> 的QQ程序，按alt+b打开百度，可以这样写</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">^q::Run D:\software\QQ.exe</span><br><span class="line">!b::Run www.baidu.com</span><br></pre></td></tr></table></figure>

<p>这样，大家就可以自定义自己的程序启动热键了</p>
<p>脚本推荐</p>
<ol>
<li>快捷启动</li>
</ol>
<p>即上面介绍的例子，自定义快捷键，快速打开程序、文件、网址等，这里给出一个模板，大家可以根据需要编辑修改</p>
<p>鼠标债见音量控制</p>
<p>把鼠标浮动在任务栏时，可以通过滚轮来调节音量，点击中键开启或关闭声音</p>
<p>屏幕键盘</p>
<p>在屏幕下方显示一个透明的模拟键盘，来实时显示我们按下的按键，也都来学习盲打时</p>
<hr>
<h2 id="创建脚本"><a href="#创建脚本" class="headerlink" title="创建脚本"></a>创建脚本</h2><p>每个脚本都是需由程序 autohotkey.exe 执行的包含命令的纯文本，脚本中还可以包含热键和热字串，或者甚至完全由它们组成，不过，在不包含热键和热字串时，脚本会在启动后从上往下顺序执行器中的命令</p>
<p>创建新脚本</p>
<p>输入文件名，确保以 .ahk 结尾，例如 test.ahk<br>右键点击此文件并选择edit script</p>
<p>在新的空行中，输入下列内容， <code>#space::Run www.bing.com</code></p>
<p>在上面的语句行中，首个字符 # 表示windows 键，所以 #space 表示按住 windows 键然后按下空格键来激活热键，双冒号 :: 表示每次按下此热键时会执行其后续命令，这里是转到google 网站，要试用此脚本，请继续下列操作</p>
<p>保存并关闭此文件</p>
<p>双击此文件来运行，在任务栏通知区域会出现新的图标</p>
<p>按住windows 键并按下空格键，在默认浏览器中会打开网页</p>
<p>要退出或编辑此脚本，则在任务栏通知区域的绿色H 图标点击右键</p>
<p>注意</p>
<p>多个脚本可以同时运行，其中的每个脚本在任务栏通知区域使用自己的图标</p>
<p>每个脚本可以包含多个热键 和热字串</p>
<p>要让您的脚本在启动计算机时自动运行，请在开始菜单的启动文件夹中给您的脚本创建快捷方式</p>
<h2 id="启动程序或文档"><a href="#启动程序或文档" class="headerlink" title="启动程序或文档"></a>启动程序或文档</h2><p>可以使用run 命令来打开其中程序，文档，url 或快捷方式，这里有一些常见示例</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Run Notepad</span><br><span class="line">Run C:\My Documents\Address List.doc</span><br><span class="line">Run C:\My Documents\My Shortcut.lnk</span><br><span class="line">Run www.yahoo.com</span><br><span class="line">Run mailto:someone@somedomain.com</span><br></pre></td></tr></table></figure>

<p>通过加上热键标签，可以把上面例子的任何一个设置为热键，在下面的首个例子中，设置的热键为win+n  而在第二个中为control+alt+c</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#n::Run Notepad</span><br><span class="line">^!c::Run calc.exe</span><br></pre></td></tr></table></figure>



<p>上面的例子被称为单行热键，因为它们只包含单个命令，要在热键中执行多个命令，请把首行放在热键定义的下面，且在最后行命令的下一行添加return 例如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#n::</span><br><span class="line">Run http://www.google.com</span><br><span class="line">Run Notepad.exe</span><br><span class="line">return</span><br></pre></td></tr></table></figure>

<p>如要要运行的程序或文档没有在环境变量中，那么需要指定它的完整路径才能运行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Run %A_ProgramFiles%\Winamp\Winamp.exe</span><br></pre></td></tr></table></figure>

<p>在上面的例子中，%A_ProgramFiles%是内置变量，使用它而不使用像 <code>C:\Program Files </code> 这样的脚本可以有更好的移植性，这表示它在其他电脑上能执行的可能性更大，注意命令和变量的名称是不区分大小写的，例如，Run 等同于 run<br>而 “A_ProgramFiles” 等同于 “a_programfiles”.</p>
<p>要让脚本等到程序或文档关闭后才继续执行，请使用RunWait 代替Run 在下面的例子中，一直到用户关闭记事本MsgBox 命令才会继续执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">RunWait Notepad</span><br><span class="line">MsgBox The user has finished (Notepad has been closed).</span><br></pre></td></tr></table></figure>

<p>要学习关于启动程序的更多能容，例如传递参数，指定工作目录和找到程序的退出代码，请点击此处</p>
<p>发送键击和鼠标点击</p>
<p>使用send 命令可以发送剪辑到活动的最前面的窗口，在下面的例子中，control+alt+s 被设置为输入签名的热键 在按下此热键前必须确保编辑器或电子邮件这样的窗口是活动的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">^!s::</span><br><span class="line">Send Sincerely,&#123;Enter&#125;John Smith</span><br><span class="line">return</span><br></pre></td></tr></table></figure>

<p>在上面的例子中，除enter 外的所有字符都按原义发送，而它则模拟按下了enter 键，下一个例子演示了其他一些常用的特殊字符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Send ^c!&#123;tab&#125;pasted:^v</span><br></pre></td></tr></table></figure>

<p>上面这行发送 Control+C 跟着 Alt+Tab 跟着字符串 “pasted:” 和 Control+V. 要了解特殊字符和按键的完整列表, 请参阅 Send.</p>
<p>最后，可以用您输入的缩写来出发发送键击的动作，这被称为热字串，例如每当您输入btw 跟着空格或逗号时，下面折行会把它替换为by the way</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">::btw::by the way</span><br></pre></td></tr></table></figure>


<p>鼠标点击</p>
<p>要发送鼠标点击到窗口，首先必须确定要点击的x 和y 坐标，这个可以用window spy 来完成，它包含在autohotkey 中，下列步骤说明了使用window spy 的方法</p>
<p>在脚本托盘图标菜单或开始菜单中运行 Window Spy.<br>通过点击感兴趣的标题栏, alt-tab 切换或其他方法激活窗口 (Window Spy 被设计为保持 “置顶”).<br>移动鼠标光标到目标窗口中想要的位置并记下 Window Spy 中显示的鼠标坐标 (或在 Windows XP 和早期版本中, 按下 Shift-Alt-Tab 来激活 Window Spy, 这样可以复制和粘贴 “冻结的” 坐标).<br>在 Click 命令中使用上面找到的坐标. 下面的例子点击鼠标左键：Click 112, 223。</p>
<p>要移动鼠标而不进行点击，请使用mousemove 要拖拉鼠标，请使用mouseclickdrag</p>
<h3 id="激活和操作窗口"><a href="#激活和操作窗口" class="headerlink" title="激活和操作窗口"></a>激活和操作窗口</h3><p>要激活窗口 使它最前面，请使用winactivate 要判断窗口是否存在，请使用ifwinexist 或winwait 下面的例子演示了这些命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">IfWinExist Untitled - Notepad</span><br><span class="line">&#123;</span><br><span class="line">    WinActivate</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">    Run Notepad</span><br><span class="line">    WinWait Untitled - Notepad</span><br><span class="line">    WinActivate</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面的例子会首先搜索标题以 “无标题 - 记事本” (区分大小写) 开始的任何现有的窗口. 如果找到这样的窗口, 则激活它. 否则, 启动记事本并等待无标题窗口的出现, 出现后激活它. 上面的例子还利用了 最近找到的窗口, 这样可以不需要在每个 WinActivate 中指定窗口标题.</p>
<p>其他一些常用的窗口命令是</p>
<p>IfWinActive: 检查指定的窗口当前是否活动.<br>WinWaitActive: 等待指定窗口变为活动窗口 (通常用在激活窗口的键击后面, 例如按下 Control-F 来打开 “查找” 窗口).<br>WinClose: 关闭指定的窗口.<br>WinMove: 改变指定窗口的位置和&#x2F;或大小.<br>WinMinimize, WinMaximize, WinRestore: 分别最小化, 最大化或还原指定窗口.</p>
<p>利用MsgBox InputBox 等从用户中获取输入</p>
<p>下面的例子显示带两个按钮的对话框</p>
<p>使用InputBox 命令来提示用户输入字符串，使用fileselectfile 或fileselectfolder 来让用户选择文件或文件夹，对于更高级的任务，请使用gui 命令来创建自定义数据输入窗体和用户界面</p>
<p>提示：您也许已经从其他例子中注意到任何命令中的首个逗号可以，除非首个参数为空或以 :&#x3D; 或 &#x3D; 开始，或命令单独处于延续片段的顶部，例如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MsgBox This is ok.</span><br><span class="line">MsgBox, This is ok too (it has an explicit comma).</span><br></pre></td></tr></table></figure>

<h2 id="使用变量和剪贴板"><a href="#使用变量和剪贴板" class="headerlink" title="使用变量和剪贴板"></a>使用变量和剪贴板</h2><p>变量是脚本用来存储文本或数字的内存块，只包含数字的变量 （可以包含小数点在数学运算或比较时会被自动转换为数字）</p>
<p>除了函数中的局部变量外，所有的变量都是全局的，即可以在脚本的任意位置读取或改变它们的内容</p>
<p>此外，变量不需要声明，简单地使用它们就可以让它们存在 且每个变量都以空或空白开始</p>
<p>要把字符串赋值给变量，请参照这些例子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MyVar1 = 123</span><br><span class="line">MyVar2 = my string</span><br></pre></td></tr></table></figure>

<p>要把变量的内容和数字或字符串进行比较，请参照这些例子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">if MyVar2 = my string</span><br><span class="line">&#123;</span><br><span class="line">    MsgBox MyVar2 contains the string &quot;my string&quot;.</span><br><span class="line">&#125;</span><br><span class="line">if MyVar1 &gt;= 100</span><br><span class="line">&#123;</span><br><span class="line">    MsgBox MyVar1 contains %MyVar1%, which is a number greater than or equal to 100.</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在上面的msgbox 行中， 注意第二个出现的myvar1 被括在百分号内，这样在那里显示了 Myvar1 的内容，使用相同的手法能用来复制一个变量的内容给另一个变量，例如</p>
<p>MyVarConcatenated &#x3D; %MyVar1% %MyVar2%</p>
<p>上面折行吧字符串123 my string 保存到 MyVarConcatenated</p>
<p>要比较两个变量的内容，请参照此例</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if (ItemCount &gt; ItemLimit)</span><br><span class="line">&#123;</span><br><span class="line">    MsgBox The value in ItemCount, which is %ItemCount%, is greater than %ItemLimit%.</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意上面例子的首行包含小括号，小括号表示这个if 语句包含表达式，如果没有它们，那行将被视为 非表达式 if 语句，并且因此需要使用百分号括住 itemlimit 这样的if 语句被限制为只能包含简单的比较运算符，而不能包含数学运算符或像  and or 这样的联合运算符</p>
<p>数学，要执行数学运算，请使用冒号-等号运算符（:&#x3D;）来把表达式的结果赋值给变量，例如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NetPrice := Price * (1 - Discount/100)</span><br></pre></td></tr></table></figure>

<p>请参阅表达式来了解数学运算符的完整列表</p>
<p>剪贴板</p>
<p>clipboard 变量是特殊变量，因为它包含了windows剪贴板中当前的文本，即使如此，它的用法也和普通变量一样，例如，下面这行将显示剪贴板当前的内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MsgBox %clipboard%</span><br></pre></td></tr></table></figure>

<p>要改变剪贴板的内容，请参考下面的例子，它用新文本替换了剪贴板的当前内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clipboard = A line of text.`r`nA second line of text.`r`n</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在上面`r `n 用来表示两个特殊字符，回车和换行，这两个字符在文本中开始新行，就像用户按下了enter键</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>要追加文本到剪贴板 (或其他任何变量), 请参照此例:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">clipboard = %clipboard% And here is the text to append.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>请参阅剪贴板 和变量章节了解详情</p>
<h3 id="反复重复–一系列动作"><a href="#反复重复–一系列动作" class="headerlink" title="反复重复–一系列动作"></a>反复重复–一系列动作</h3><p>要多次连续地重复执行一些操作，请使用循环，下面的循环会显示三次 msgbox</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Loop 3</span><br><span class="line">&#123;</span><br><span class="line">    MsgBox This window will be displayed three times.</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>您还可以再单词loop 后指定变量，这可以用于循环次数在脚本某个位置定义的时候</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Loop %RunCount%</span><br><span class="line">&#123;</span><br><span class="line">    Run C:\Check Server Status.exe</span><br><span class="line">    Sleep 60000  ; 暂停 60 秒.</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在上面的例子中，循环会执行指定的次数，但是如果runcount 的值为0 则会完全跳过循环</p>
<p>当一个或多个条件改变时循环还可以终止它自己，下面的例子中当用户按住F1 键时会重复点击鼠标左键</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$F1::  ; 把 F1 键设置为热键 ($ 符号会有助于下面 GetKeyState 的 &quot;P&quot; 模式).</span><br><span class="line">Loop  ; 由于没有指定数字, 所以这是个无限循环, 直到遇到内部的 &quot;break&quot; 或 &quot;return&quot;.</span><br><span class="line">&#123;</span><br><span class="line">    if not GetKeyState(&quot;F1&quot;, &quot;P&quot;)  ; 如果此状态为 true, 那么用户实际已经释放了 F1 键.</span><br><span class="line">        break  ; 中断循环.</span><br><span class="line">    ; 否则 (由于上面没有 &quot;中断&quot;), 继续点击鼠标.</span><br><span class="line">    Click  ; 在当前指针位置点击鼠标左键.</span><br><span class="line">&#125;</span><br><span class="line">return</span><br></pre></td></tr></table></figure>

<p>在上面的例子中，当用户按下F1键时，循环会检测到并通过break 命令停止它自己，break 会执行行跳转到循环闭括号后的行</p>
<p>另一种实现此目的的方法是使用while 循环</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$F1::</span><br><span class="line">while GetKeyState(&quot;F1&quot;, &quot;P&quot;)  ; 当 F1 键实际被按住时.</span><br><span class="line">&#123;</span><br><span class="line">    Click</span><br><span class="line">&#125;</span><br><span class="line">return</span><br></pre></td></tr></table></figure>


<p>上面的示例演示了一般用途的循环，对于更多特殊的需要，请考虑下面这些循环</p>
<p>文件读取&#x2F;写入循环，逐行读取文本文件的内容，每次一个，这可以用来对符合条件的文件或文件夹进行操作</p>
<p>解析循环，从一个字符串中获取子字符串，每次一个，这可以用来很容易的分解像 red green blue 这样的字符串为三个子片段</p>
<p>注册表循环  获取指定的注册表子键的内容，每次一个项目</p>
<h3 id="操作文件和文件夹"><a href="#操作文件和文件夹" class="headerlink" title="操作文件和文件夹"></a>操作文件和文件夹</h3><p>要添加文本到文件的末尾，或创建新文件，请使用fileappend 如下面的例子所示，注意它使用<code>n </code> 换行符 来开始新的文本行</p>
<p>要覆盖现有的文件，请在fileappend 之前使用filedelete ，例如</p>
<p>FileDelete, C:\My Documents\My Text File.txt</p>
<p>其他一些常用的文件和文件夹命令是</p>
<p>FileRead: 读取整个文件的内容到变量.<br>文件读取循环: 逐行读取文本文件的内容.<br>IfExist: 检查文件或文件夹是否存在.<br>FileSelectFile 和 FileSelectFolder: 显示可以让用户选取文件或文件夹的对话框.<br>FileDelete&#x2F;FileRecycle: 删除&#x2F;回收一个或多个文件. 使用 FileRemoveDir 来删除整个文件夹.<br>FileCopy&#x2F;FileMove: 复制&#x2F;移动一个或多个文件. 使用 FileCopyDir&#x2F;FileMoveDir 来复制&#x2F;移动整个文件夹.<br>文件和文件夹循环: 获取文件夹中包含的子文件夹和文件, 每次一个.<br>FileSetAttrib 和 FileSetTime: 改变一个或多个文件的属性或时间戳.<br>IniRead, IniWrite 和 IniDelete: 创建, 访问和操作标准格式的 INI 文件.<br>RegRead, RegWrite, RegDelete 和 注册表循环: 操作 Windows 注册表.</p>
<h1 id="命令和函数索引"><a href="#命令和函数索引" class="headerlink" title="命令和函数索引"></a>命令和函数索引</h1><p><code>&#123; ... &#125;</code> 一对大括号组成的区域表示一个区块，区块通常与函数 else loop while 循环和if 命令一起使用</p>
<p><code>&#123;...&#125;</code> 创建脚本化关联数组</p>
<p><code>[...]</code> 创建含整数键的脚本化关联数组</p>
<p>break  退出 终止循环，在各种循环中都是有效的</p>
<p>catch 指定在执行try 语句发生异常时执行的代码</p>
<p>click 在指定坐标处点击鼠标按钮，它还可以按下鼠标按钮，转动鼠标滚轮或移动鼠标</p>
<p>clipwait 等待，一直到剪贴板包含数据</p>
<p>comobjcreate 创建com 对象</p>
<p>dllcall 调用dll 文件中的函数，例如标准的windows api 函数</p>
<p>else 指定当if 语句计算结果为false 时执行的命令，包含多个命令时，需要把它们括在 区块中</p>
<p>envadd 设置变量的值为它自身加上给定的值的和，还可以从日期-时间值中增加或减去时间，同义 于  var+&#x3D; value</p>
<p>ExitApp  无条件终止脚本</p>
<p>FileAppend 在文件末尾处追加文本  如果有必要，首先创建文本</p>
<p>FileDelete 删除一个或多个文件</p>
<p>FileOpen 提供面向对象的文件io</p>
<p>fileread 读取文件的内容到变量</p>
<p>fileselectfile 显示可以让用户打开或保存文件的标准对话框</p>
<p>Finally 确保 在try 语句结束后总是会执行的代码块</p>
<p>For 对对象中的每对键值对重复执行一系列命令</p>
<p>Gosub 跳转到指定的标签并继续执行</p>
<p>Gui 创建和管理窗口和控件，这种窗口可以用作数据输入窗体或自定义用户界面</p>
<p>if 指定在变量与值比较结果为true 时执行的命令，包含多个命令时，需要把它们括在区块 大括号中</p>
<p>ifwinExist  检查指定的窗口是否存在</p>
<p>inputbox 显示输入框让用户输入字符串</p>
<p>loop 普通  重复执行一系列命令：可以指定表示重复次数的数字或直到遇到break</p>
<p>loop 读物文件内容 逐行读取文本文件的内容，每次一行，比filereadline 执行的更好</p>
<p>MouseGetPos 获取鼠标光标的当前位置以及鼠标当前悬停的窗口和控件，可选的</p>
<p>MsgBox 在含有一个或个多按钮 的小窗口中显示指定的文本</p>
<p>RegExMatch 判断字符串是否包含某个匹配模式 正则表达式</p>
<p>RegExReplace 替换字符串中匹配模式 正则表达式 出现的地方</p>
<p>Return 从子程序返回到之前通过函数调用 gosub 激活 hotkey groupactivate 或其他方式执行跳转的地方</p>
<p>运行 运行外部程序</p>
<p>runwait 运行外部程序并等待期结束</p>
<p>Send SendRaw 发送模拟键击和鼠标点击到活动窗口</p>
<p>SetBatchLines 设置脚本的执行速度 影响CPU使用率</p>
<p>SetTimer 以指定的时间间隔自动并重复运行子程序</p>
<p>SetTitleMatchMode 设置在类似winwait 命令中wintitle 参数的匹配模式</p>
<p>setwindelay 设置在每次执行窗口命令 例如winactivate 后自动的延时</p>
<p>Sleep 在继续前等待指定的时间量</p>
<p>splitpath 把文件名或url 分解成它的名称，目录，扩展名和驱动器</p>
<p>StringGetPos instr 获取指定的子字符串在某个字符串中的位置</p>
<p>strlen 获取字符中包含的字符数量</p>
<p>substr从字符串的指定位置提取一个或多个字符</p>
<p>stringreplace 用新字符串替换执行的子字符串</p>
<p>Throw 发出错误发生的信号，此信号可以被try-catch 语句捕获</p>
<p>try 守护一个或多个语句 命令或表达式以防备由throw 命令抛出的运行时错误和异常</p>
<p>until 根据条件判断是否继续执行loop 或for 循环</p>
<p>var&#x3D;value 把指定的值赋给变量</p>
<p>var:&#x3D; expression 计算表法师并把结果保存在变量</p>
<p>varsetcapacity 增加或清空变量占用的内存，通常只有在特殊情况下才需要，例如 dllcall</p>
<p>while 循环 重复执行一系列命令，一直到指定的表达式计算结果为假</p>
<p>win activate 激活指定的窗口</p>
<p>winclose 关闭指定的窗口</p>
<p>win exist 返回首个匹配窗口的唯一id</p>
<p>wingettitle 获取指定窗口的标题</p>
<p>winhide 隐藏指定的窗口</p>
<p>winmaximize 最大化指定的窗口</p>
<p>winminimize 缩小指定窗口为任务栏上的按钮</p>
<p>winwait 等到指定的窗口出现</p>
<h1 id="基本用法和语法"><a href="#基本用法和语法" class="headerlink" title="基本用法和语法"></a>基本用法和语法</h1><h2 id="热键"><a href="#热键" class="headerlink" title="热键"></a>热键</h2><p>热键有时也称为快捷键，因为它们能简便地出发动作，例如运行程序或键盘宏，</p>
<p>要在热键中使用多个修饰键，那么需要把它们连续地列出来，顺序无关紧要，下面的例子中使用<code>^!s</code> 来表示control+alt+s</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">^!s::</span><br><span class="line">Send Sincerely,&#123;enter&#125;John Smith  ; 此行发送键击到活动 (最前面的) 窗口.</span><br><span class="line">return</span><br></pre></td></tr></table></figure>


<h3 id="在定义热键时您可以使用下列修饰符"><a href="#在定义热键时您可以使用下列修饰符" class="headerlink" title="在定义热键时您可以使用下列修饰符"></a>在定义热键时您可以使用下列修饰符</h3><p># 对于 Windows Vista 及以上版本, 包含 Windows 键的热键 (例如 #a) 会等待 Windows 键被释放后才发送任何包含 “L” 键击的文本. 这样避免了这种热键中的 Send 锁定 PC。这种行为适用于除 SendPlay (这里不需要) 和 盲从模式 外的所有发送模式.</p>
<p>! alt</p>
<p>^ control</p>
<ul>
<li>shift</li>
</ul>
<p>&amp; 和符号可以用来组合任意两个按键或鼠标按钮，让它们成为自定义热键，请参阅后面了解详情</p>
<p>&lt; 使用成对按键中左边的那个 例如<code>&lt;!a</code> 相当于<code>!a</code> 只是使用左边alt 键才可以触发</p>
<p><code>&gt;</code> 使用成对按键中右边的那个</p>
<p>&lt;^&gt;! altGr 如果您键盘布局中含altGr 键而非右alt 键，那么这一系列符号一般可用于表示altgr 例如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;^&gt;!m::MsgBox You pressed AltGr+m.</span><br><span class="line">&lt;^&lt;!m::MsgBox You pressed LeftControl+LeftAlt+m.</span><br></pre></td></tr></table></figure>

<p>或者让altGr 自己成为热键，请使用下面的热键，不像上面出现的任何热键</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LControl &amp; RAlt::MsgBox You pressed AltGr itself.</span><br></pre></td></tr></table></figure>

<ul>
<li>通配符，即使附加的休时间也被按住也能激发热键，这常与重映射按键或按钮组合使用，例如</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*#c::Run Calc.exe  ; Win+C、Shift+Win+C、Ctrl+Win+C 等都会触发此热键。</span><br><span class="line">*ScrollLock::Run Notepad  ; 即使在按住其他修饰键时按下 ScrollLock 也会触发此热键。</span><br></pre></td></tr></table></figure>

<p>~ 激发热键时，不会屏蔽，被操作系统隐藏，热键中按键原有的功能，在下面的两个例子中，用户的鼠标按钮点击会被发送到活动窗口</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~RButton::MsgBox You clicked the right mouse button.</span><br><span class="line">~RButton &amp; C::MsgBox You pressed C while holding down the right mouse button.</span><br></pre></td></tr></table></figure>

<p>注意， 与其他前缀符号不同，可以在某些热键的变体中使用颚化符前缀而其他的不使用</p>
<ol start="2">
<li>代替 alt-tab 的特殊热键总是忽略颚化符前缀。<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[v1.1.14+]：如果把颚化符前缀用在自定义修饰键中且此修饰键自身也作为热键，则在按下此修饰键时会触发热键而不会被延迟到按键释放的时候。例如，上文中~RButton热键在按下此按键时就会触发。对于v1.1.14之前的版本（或未使用颚化符前缀）， 则会在按键释放时触发其自身的热键，不过仅在未触发RButton &amp; C组合键的时候。</span><br></pre></td></tr></table></figure></li>
</ol>
<p>$ 通常只在脚本使用send 命令发送包含了热键自身的按键时才需要使用此符号，此时可以避免触发它自己 $ 前缀强制使用键盘钩子，来实现此热键，作为一个副作用这样避免了send 命令触发它自己，$ 前缀相当于在此热键定义之前的某个位置指定的 <code>#usehook</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[v1.1.06+]: #InputLevel 和 SendLevel 对send 命令是否触发热键和热字符串提供了额外的控制功能</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>up </p>
<p>单词 UP 可以跟在热键名后面使得在释放按键时触发热键, 而不是按下时. 下面的例子把 LWin <a target="_blank" rel="noopener" href="https://ahkcn.sourceforge.net/docs/misc/Remap.htm">重映射</a> 为 LControl:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*LWin::Send &#123;LControl Down&#125;</span><br><span class="line">*LWin Up::Send &#123;LControl Up&#125;</span><br></pre></td></tr></table></figure>

<p>“Up”也可以用于普通热键中，例如：<code>^!r Up::MsgBox You pressed and released Ctrl+Alt+R</code>。它还可以用在<a target="_blank" rel="noopener" href="https://ahkcn.sourceforge.net/docs/Hotkeys.htm#combo">组合键</a>（例如 <code>F1 &amp; e Up::</code>）</p>
<p>限制：1) “Up”不能和<a target="_blank" rel="noopener" href="https://ahkcn.sourceforge.net/docs/KeyList.htm">游戏杆按钮</a>一起使用；2) 在没有普通&#x2F;按下热键副本的“Up”热键会完全接管那个按键以防被卡住。避免这种情况的一种方法是添加<a target="_blank" rel="noopener" href="https://ahkcn.sourceforge.net/docs/Hotkeys.htm#Tilde">颚化符前缀</a>（例如 <code>**~**LControl up::</code>）</p>
<p>相关提示, 类似于上面的一种技术是让热键成为前缀键. 好处是尽管热键会在按键松开时激发, 但仅在您之前按住此前缀键时没有按其他任何键的情况下才会如此. 例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LControl &amp; F1::return  ; 通过把左 control 键放在 &quot;&amp;&quot; 前面至少一次来让它成为前缀键.</span><br><span class="line">LControl::MsgBox You released LControl without having used it to modify any other key.</span><br></pre></td></tr></table></figure>

<p>多个热键可以垂直地叠放来让它们执行相同的动作，例如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">^Numpad0::</span><br><span class="line">^Numpad1::</span><br><span class="line">MsgBox Pressing either Control+Numpad0 or Control+Numpad1 will display this message.</span><br><span class="line">return</span><br></pre></td></tr></table></figure>

<p>通过不为热键或按键组合的热键指定任何操作可以在整个系统重完全禁用它们，下面的例子中禁用了右windows 键</p>
<p>RWin::return</p>
<h3 id="上下文相关的热键"><a href="#上下文相关的热键" class="headerlink" title="上下文相关的热键"></a>上下文相关的热键</h3><p>#IfWinActive&#x2F;Exist 和 #If 指令可以用来让热键根据不同的条件执行不同的动作 (或什么都不做). 例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#IfWinActive, ahk_class Notepad</span><br><span class="line">^a::MsgBox You pressed Ctrl-A while Notepad is active. Pressing Ctrl-A in any other window will pass the Ctrl-A keystroke to that window.</span><br><span class="line">#c::MsgBox You pressed Win-C while Notepad is active.</span><br><span class="line"></span><br><span class="line">#IfWinActive</span><br><span class="line">#c::MsgBox You pressed Win-C while any window except Notepad is active.</span><br><span class="line"></span><br><span class="line">#If MouseIsOver(&quot;ahk_class Shell_TrayWnd&quot;)</span><br><span class="line">WheelUp::Send &#123;Volume_Up&#125;     ; 在任务栏上滚动滚轮：增加/减小音量。</span><br><span class="line">WheelDown::Send &#123;Volume_Down&#125; ;</span><br></pre></td></tr></table></figure>

<h3 id="自定义组合键及其他特性"><a href="#自定义组合键及其他特性" class="headerlink" title="自定义组合键及其他特性"></a>自定义组合键及其他特性</h3><p>通过在两个按键 不包括操纵杆按钮 间使用&amp; 可以定义定制的组合键，在下面的例子中，您在按住numpad0 接着按下第二个按键时会触发此热键</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Numpad0 &amp; Numpad1::MsgBox You pressed Numpad1 while holding down Numpad0.</span><br><span class="line">Numpad0 &amp; Numpad2::Run Notepad</span><br></pre></td></tr></table></figure>

<p>在上面的例子中，numpad0 成为前缀键，但是这也让numpad0 在被按下时失去了它原有的功能，为了避免此问题，脚本中可以配置numpad0 执行新的动作，例如下列热键的其中一个</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Numpad0::WinMaximize A   ; 最大化活动/前端窗口.</span><br><span class="line">Numpad0::Send &#123;Numpad0&#125;  ; 让 Numpad0 释放 时产生 Numpad0 键击. 请参阅下面的注释.</span><br></pre></td></tr></table></figure>

<p>使用上面的其中一个自定义组合热键可以在释放numpad0时执行指定的动作，但仅在您之前按住numpad0 时没有按其他任何按键的情况下，在 v1.1.14+ 中，可以在其中某个热键使用颚化符前缀来避免这种行为</p>
<p>Numlock, Capslock 和 Scrolllock: 这些键可以被强制设置为 “AlwaysOn” 或 “AlwaysOff”. 例如：SetNumlockState AlwaysOn。</p>
<p>覆盖资源管理器热键，在脚本中可以为windows 内置的热键例如Win-E和Win-R指定一个动作来个别的替换，请参阅覆盖页面了解详情</p>
<p>替换alt-tab 热键可以提供alt-tab切换窗口的可选方法，例如，下面的两个热键可以让您用右手进行alt-tab</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">RControl &amp; RShift::AltTab  ; 按住右 control 后接着反复下右 shift 来向前移动.</span><br><span class="line">RControl &amp; Enter::ShiftAltTab  ; 甚至不需要释放右 control, 直接按 Enter 来反向移动.</span><br></pre></td></tr></table></figure>

<p>鼠标滚轮热键</p>
<p>通过键名 wheeldown 和wheelup 可以支持转动滚轮来激发热键，在 v1.0.48+ 中还支持 WheelLeft 和 WheelRight，但在早于 Windows Vista 的操作系统上没有效果。这里是一些鼠标滚轮热键的例子:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MButton &amp; WheelDown::MsgBox You turned the mouse wheel down while holding down the middle button.</span><br><span class="line">^!WheelUp::MsgBox You rotated the wheel up while holding down Control+Alt.</span><br></pre></td></tr></table></figure>

<p>在 v1.0.43.03+, 内置变量 <strong>A_EventInfo</strong> 包含了滚轮转动的格数, 通常为 1. 然而在后面的情况中, A_EventInfo 可能大于或小于 1:</p>
<ul>
<li>如果鼠标硬件报告小于一格的距离, 那么 A_EventInfo 可能为 0;</li>
<li>如果快速滚动滚轮 (取决于鼠标类型), 那么 A_EventInfo 可能大于 1. 像后面这样的热键可以帮助您分析鼠标：<code>~WheelDown::ToolTip %A_EventInfo%</code>。</li>
</ul>
<p>鼠标滚轮最有用的一些热键包括滚动窗口文本的可选方法. 例如, 使用下面的一对热键可以在您按住左 Control 键并转动滚轮时进行水平滚动而不是垂直滚动:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">~LControl &amp; WheelUp::  ; 向左滚动.</span><br><span class="line">ControlGetFocus, fcontrol, A</span><br><span class="line">Loop 2  ; &lt;-- 增加这个值来加快滚动速度.</span><br><span class="line">    SendMessage, 0x114, 0, 0, %fcontrol%, A  ; 0x114 是 WM_HSCROLL, 它后面的 0 是 SB_LINELEFT.</span><br><span class="line">return</span><br><span class="line"></span><br><span class="line">~LControl &amp; WheelDown::  ; 向右滚动.</span><br><span class="line">ControlGetFocus, fcontrol, A</span><br><span class="line">Loop 2  ; &lt;-- 增加这个值来加快滚动速度.</span><br><span class="line">    SendMessage, 0x114, 1, 0, %fcontrol%, A  ; 0x114 是 WM_HSCROLL, 它后面的 1 是 SB_LINERIGHT.</span><br><span class="line">return</span><br></pre></td></tr></table></figure>

<p>最后, 由于鼠标滚轮热键只产生按下事件 (从没有弹起事件), 所以它们无法用作 <a target="_blank" rel="noopener" href="https://ahkcn.sourceforge.net/docs/Hotkeys.htm#keyup">弹起的按键热键</a>.</p>
<p>热键技巧和备注</p>
<p>根据numlock 的状态，每个小键盘上的按键可以运行两个不同的热键子程序，可选的，可以让小键盘上的按键不论NumLock的状态如何都运行相同的子程序，例如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">NumpadEnd::</span><br><span class="line">Numpad1::</span><br><span class="line">MsgBox, This hotkey is launched regardless of whether Numlock is on.</span><br><span class="line">return</span><br></pre></td></tr></table></figure>

<p>如果颚化符~ 和前缀键一起使用，即使只是一次，那么其中的前缀总是会被发送到活动窗口，例如，在下面的两个热键中，活动窗口都会收到右键点击，尽管只是其中一个热键使用了颚化符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~RButton &amp; LButton::MsgBox You pressed the left mouse button while holding down the right.</span><br><span class="line">RButton &amp; WheelUp::MsgBox You turned the mouse wheel up while holding down the right button.</span><br></pre></td></tr></table></figure>

<p>Suspend 命令可以临时禁用所有的热键 但不包括您要排除的那些，要得到更大的选择性，请使用 #IfWinActive&#x2F;Exist.</p>
<p>通过使用hotkey 命令，可以在脚本运行时动态创建热键，hotkey 命令还能单独地修改，禁用或启用脚本现有的热键</p>
<p>操纵杆热键当前不支持修饰符前缀，例如 <code>^ (Control)</code> 和 <code># (Win)</code>. 不过, 您可以使用 GetKeyState 来模仿这种效果, 如下所示:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Joy2::</span><br><span class="line">if not GetKeyState(&quot;Control&quot;)  ; 左边和右边的 Control 键都没有按下.</span><br><span class="line">    return  ; 即什么都不做.</span><br><span class="line">MsgBox You pressed the first joystick&#x27;s second button while holding down the Control key.</span><br><span class="line">return</span><br></pre></td></tr></table></figure>

<p>如果热键应该在继续执行前等待其修饰键释放，这可能需要一些时间，请参考下面的例子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^!s::Send &#123;Delete&#125;</span><br></pre></td></tr></table></figure>

<p>按下 Control-Alt-S 会让系统以为您按下了 Control-Alt-Delete (由于系统对 Ctrl-Alt-Delete 的侵略性检测). 要变通解决此问题, 请使用 KeyWait 来等待按键释放; 例如:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">^!s::</span><br><span class="line">KeyWait Control</span><br><span class="line">KeyWait Alt</span><br><span class="line">Send &#123;Delete&#125;</span><br><span class="line">return</span><br></pre></td></tr></table></figure>

<p>如果像<code>#z::</code> 这样的热键标签产生了乌龙茶无效热键的错误，那么您的系统键盘布局语言可能不包含特殊字符，尝试使用您键盘布局中您知道的其他字符</p>
<p>热键标签可以作为 gosub 或goto 的目标，例如 <code>gosub ^!s</code></p>
<p>热键的一个常见用途是启动和停止重复的动作，例如一系列的键击或鼠标点击，关于这方面的例子，请参阅这个FAQ主题</p>
<p>最后，每个脚本都是准多线程的，这样可以在之前的热键子程序还在运行时启动新的热键，例如，即使在当前热键显示msgbox 时也能启动新热键</p>
<p>alt-tab 热键</p>
<p>每个alt-tab 热键必须是两个键的组合，通常通过和符号&amp; 实现，在下面的例子中，按住右alt 键并按下J 或K 可以导航alt-tab 菜单</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">RAlt &amp; j::AltTab</span><br><span class="line">RAlt &amp; k::ShiftAltTab</span><br></pre></td></tr></table></figure>

<p>AltTab 和shiftAltTab 是两个特殊的命令，它们仅在与热键在同一行时才能被识别，这里是完整的列表</p>
<p>alttab 如果alttab 菜单可见，那么在菜单中前移，否则，显示菜单</p>
<p>shiftalttab 与上面相同，不过这里在菜单中后移</p>
<p>AltTabAndMenu：如果 alt-tab 菜单可见，那么在菜单中前移。否则, 显示菜单.</p>
<p>AltTabMenuDismiss: 关闭 Alt-tab 菜单.</p>
<p>为了举例说明上述命令，可以用鼠标滚轮完全代替alt-tab  当下面的热键生效时，点击鼠标中键显示菜单，转动滚轮在菜单中导航</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MButton::AltTabMenu</span><br><span class="line">WheelDown::AltTab</span><br><span class="line">WheelUp::ShiftAltTab</span><br></pre></td></tr></table></figure>

<p>要取消热键调用的alt-tab 菜单而不激活选择的窗口，请使用类似下面这样的热键，它可能需要根据后面的这些进行调整，最初显示alt-tab 菜单的方法，和2 脚本是否安装了键盘钩子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">LCtrl &amp; CapsLock::AltTab</span><br><span class="line">!MButton::  ; 鼠标中键. ! 前缀让它在按住 Alt 键时激发 (当 alt-tab 菜单可见时, alt 键是按住的).</span><br><span class="line">IfWinExist ahk_class #32771  ; 表示 alt-tab 菜单出现在屏幕上.</span><br><span class="line">    Send !&#123;Escape&#125;&#123;Alt up&#125;</span><br><span class="line">return</span><br></pre></td></tr></table></figure>

<p>当前，所有特殊的alt-tab 动作必须像上面的例子那样直接指定到热键上，<br>自定义的alt-tab 动作还可以通过热键创建，在下面的例子中，按下f1来显示菜单并预先向前移动，然后可以按下f2 来激活选择的窗口，或按下escape 取消</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">*F1::Send &#123;Alt down&#125;&#123;tab&#125; ; 这里需要星号.</span><br><span class="line">!F2::Send &#123;Alt up&#125;  ; 释放 Alt 键激活选择的窗口.</span><br><span class="line">~*Escape::</span><br><span class="line">IfWinExist ahk_class #32771</span><br><span class="line">    Send &#123;Escape&#125;&#123;Alt up&#125;  ; 取消菜单而不激活选择的窗口.</span><br><span class="line">return</span><br></pre></td></tr></table></figure>

<h3 id="热字串和自动替换"><a href="#热字串和自动替换" class="headerlink" title="热字串和自动替换"></a>热字串和自动替换</h3><h4 id="入门和简单示例"><a href="#入门和简单示例" class="headerlink" title="入门和简单示例"></a>入门和简单示例</h4><p>尽管热字串主要用于在您输入缩写时进行扩展，自动替换，但是它们也可以用来运行任何脚本动作，从这个角度看，它们类似于热键，只是它们通常由多个字符组成，即字符串</p>
<p>要定义热字串，请用两个冒号包围用来触发的缩写，例如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">::btw::by the way</span><br></pre></td></tr></table></figure>


<p>上面的 “by the way” 示例被称为自动替换热字串, 因为输入的文本被自动替换为第二个双冒号后指定的字符串. 与之相比, 热字串还可以定义用来执行任何自定义动作, 例如. 注意命令必须放在热字串的 下面.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">::btw::</span><br><span class="line">MsgBox You typed &quot;btw&quot;.</span><br><span class="line">return</span><br><span class="line"></span><br><span class="line">:*:]d::  ; 此热字串通过后面的命令把 &quot;]d&quot; 替换成当前日期和时间.</span><br><span class="line">FormatTime, CurrentDateTime,, M/d/yyyy h:mm tt  ; 看起来会像 9/1/2005 3:53 PM 这样</span><br><span class="line">SendInput %CurrentDateTime%</span><br><span class="line">return</span><br></pre></td></tr></table></figure>

<p>尽管上面的两个例子不是自动替换的热字串，但默认情况下您输入的缩写也会被擦除，这是通过自动退格来实现的，此特性可以通过b0 选项禁用</p>
<h4 id="终止符"><a href="#终止符" class="headerlink" title="终止符"></a>终止符</h4><p>除非使用了星号选项，否则您必须在热字串的缩写后输入终止符才能触发它</p>
<p>开始时终止符包含下列字符<br>：-()[]{}’:;”&#x2F;,.?!<code>n </code>t（注意 <code>n 是回车，</code>t 是 Tab，且在它们之间还有一个原义的空格）。通过编辑下列示例可以改变这个字符集合，这个例子中为 所有的 热字串设置新的终止符，而不仅是在它下面的那些。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#Hotstring EndChars -()[]&#123;&#125;:;&#x27;&quot;/\,.?!`n `t</span><br></pre></td></tr></table></figure>

<p>选项</p>
<p>可以使用下面的两种方式改变热字串的默认行为</p>
<p>#Hostring 指令，它会影响脚本中实际在它后面的所有热字串，下列示例会让C 和R 选项生效</p>
<p>下面列表中对每个选项进行说明，当使用上面的方法指定多个选项时，可以在选项间包含空格</p>
<ul>
<li>星号 不需要终止符，即空格，句点或回车来触发热字串</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:*:j@::jsmith@somedomain.com</span><br></pre></td></tr></table></figure>

<p>上面的示例会在您输入@字符时立即进行替换，如果在#hostring 指令中含有此选项，那么可以使用<code>*0</code>来关闭它</p>
<p>? 问号即使此热字串在另一个单词中也会被处罚，即，在字符串被混排前立即输入字符，例如，如果 <code>:?:al::airline</code> 为热字串，那么输入“practical ”会得到“practicairline ”。使用 ?0 来关闭此选项.</p>
<p>B0 (B 后跟着零): 不 进行自动退格来擦除您输入的缩写. 关闭此选项后可以使用 B 来启用. 脚本还可以通过 <code>&#123;bs 5&#125;</code> 实现自己的退格, 这里发送 5 次退格. 同样地, 可以通过 <code>&#123;left 5&#125;</code> 发送左方向键的键击. 例如，下面的热字串产生<code>“&lt;em&gt;&lt;/em&gt;”</code>并把光标向左移动 5 个位置（这样它就在标签之间了）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:*b0:&lt;em&gt;::&lt;/em&gt;&#123;left 5&#125;</span><br></pre></td></tr></table></figure>

<p>C 区分大小写，当您输入缩写时，它必须准确匹配脚本中定义的大小写形式，使用C0 可以关闭区分大小写的特性</p>
<p>C1 不遵循输入的大小写形式，使用此选项可以让 自动替换热字串 不区分大小写且阻止它们遵循您实际输入字符的大小写形式. 遵循大小写形式的热字串 (这是默认状态) 会在您输入的缩写都为大写时产生大写形式的的替换文本. 如果您的输入只有首字母为大写，那么替换的首字母也会为标题格式（如果首个字符是字母）。您按其他任何大小写形式输入时, 替换会准确按照定义进行发送. 如果在 #Hotstring 指令 中含有此选项, 那么可以使用 C0 来关闭它, 这样可以让热字串重新遵循大小写.</p>
<p>Kn 按键延迟，这个非常少用的选项设置在自动退格或自动替换产生的键击之间的延迟，给n指定新的延迟，例如，指定k10来设置10ms 的延迟而k-1 则取消延迟，此选项的实际效果取决于当前生效的发送模式</p>
<p>SI (SendInput): 由于此模式是没有延迟的, 所以按键延迟会被忽略. 例外是当 SendInput 不可用时, 此时热字串会恢复到下面的 SendPlay 模式 (它会遵循按键延迟).</p>
<p>SP (SendPlay): 默认延迟为零, 这对于 SendPlay 相当于 -1 (没有延迟). 此模式中, 这个延迟实际是 按住时长 而不是键击之间的延迟.</p>
<p>SE (SendEvent): 默认延迟为零. 在大多情况下建议使用零的延迟, 因为这样快速且与其他进程配合比较好 (由于会内部执行 Sleep 0). 指定 k-1 则不使用延迟, 这样可以在您 CPU 经常高负荷运行时让自动替换更快速地进行. 设置为 -1 时, 脚本的进程优先级会成为键击发送速度的重要因素. 要提升脚本的优先级，请使用 Process, Priority,, High。</p>
<p>O: 进行替换时忽略 自动替换热字串 的终止符. 它可以用于当您希望使用终止符让热字串保持清晰, 却不希望终止符显示在屏幕上的时候. 例如，如果 :o:ar::aristocrat 为热字串，那么输入“ar”后跟着空格键会产生不含尾随空格的“aristocrat”，这样可以让您在不需要退格的情况下补上单词的复数或所有格形式。使用 O0 (字母 O 后跟着零) 来关闭此选项.</p>
<p>Pn: 字符串的 优先级 (例如 P1). 这个非常少用的选项对 自动替换热字串 没有效果.</p>
<p>R: 发送原始的替换文本; 即准确地按照原样发送, 而不把 {Enter} 转换成 ENTER 键击, 把 ^c 转换成 Control-C, 等等. 此选项在含 延续片段 热字串中自动生效. 使用 R0 来关闭此选项.</p>
<p>SI、SP 或 SE [v1.0.43+]：设置自动替换热字串发送键击的方法。这些选项是互相排斥的: 每次只会有一个生效. 下面对每个选项进行说明:</p>
<p>SI 表示 SendInput, 它通常比其他模式拥有较好的速度和可靠性. 另一个好处是和下面的 SendPlay 一样, SendInput 会在热字串 自动替换文本 时会延迟您输入的内容. 这样避免了您的键击穿插到替换的内容中. 当 SendInput 不可用时, 热字串会自动使用 SendPlay.<br>SP 表示 SendPlay, 它可以让热字串运行在更大范围的游戏中.<br>SE 表示 SendEvent, 在比 1.0.43 早的版本中这是默认选项.</p>
<p>如果未使用上面的任何一个选项，则在v1.0.43及更高的版本中默认模式未sendinput 然而，与si 选项不同的是，在sendinput 不可用时会使用sendevent 而不是sendplay</p>
<p>Z 这个非常少用的选项会在每次热字串触发后重置热字串识别器，换句话说，脚本将开始等待全新的热字串，而不考虑您之前输入的任何内容，这可以避免意外地触发字符串，为了进行说明，请思考下面的字符串</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">:b0*?:11::</span><br><span class="line">SendInput xx</span><br><span class="line">return</span><br></pre></td></tr></table></figure>
<p>由于上面没有使用 Z 选项, 所以输入 111 (三个连续的 1) 会触发热字串两次, 因为中间的 1 既是首次触发的 末尾 字符, 又是第二次触发的 起始 字符. 在 b0 前面加上字母 Z 后, 您必须输入四个 1 而不是三个才能触发热键两次. 使用 Z0 来关闭此选项.</p>
<p>超长替换</p>
<p>使用延续片段的方法可以让产生大量替换文本的热字串更具可读性和可维护性，例如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">::text1::</span><br><span class="line">(</span><br><span class="line">Any text between the top and bottom parentheses is treated literally, including commas and percent signs.</span><br><span class="line">By default, the hard carriage return (Enter) between the previous line and this one is also preserved.</span><br><span class="line">    By default, the indentation (tab) to the left of this line is preserved.</span><br><span class="line"></span><br><span class="line">See continuation section for how to change these default behaviors.</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>使用延续片段后也会使热字串默认为原始模式，覆盖此特性的唯一方法是在每个含延续片段的热字串中指定 r0 选项 （例如 :r0:text1::）。</p>
<h2 id="上下文相关的热字串"><a href="#上下文相关的热字串" class="headerlink" title="上下文相关的热字串"></a>上下文相关的热字串</h2><p>使用#ifwinactive&#x2F;exist 指令可以让选择的热字串产生上下文相关性，这样的热字串会根据窗口是否活动或存在的不同情况发送不同的替换，执行不同的动作或什么都不做，例如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#IfWinActive ahk_class Notepad</span><br><span class="line">::btw::This replacement text will appear only in Notepad.</span><br><span class="line">#IfWinActive</span><br><span class="line">::btw::This replacement text appears in windows other than Notepad.</span><br></pre></td></tr></table></figure>

<h3 id="自动更正"><a href="#自动更正" class="headerlink" title="自动更正"></a>自动更正</h3><p>后面的脚本使用热字串及时更正大约4700常见的英文拼写错误，它还包含了win+H 热键来方便地添加更多拼写错误</p>
<h3 id="备注"><a href="#备注" class="headerlink" title="备注"></a>备注</h3><p>替换文本中当前不支持例如<code>%MyVar%</code>这样的变量引用，要解决此问题，请不要让这样的热字串自动替换，而是在缩写下面使用sendinput 命令，后跟着仅包含单词return 的行</p>
<p>要在替换文本后发送额外的空格或tab，可以把它们加在替换文本后，但需要在末尾加上重音符反引号，例如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:*:btw::By the way `</span><br></pre></td></tr></table></figure>

<h3 id="热字串助手"><a href="#热字串助手" class="headerlink" title="热字串助手"></a>热字串助手</h3><p>Andreas Borutta 推荐了下面额定脚本，如果您是深度的热字串用户，那么它会很有用，使用win+h 可以包当前选择的文本转变为热字串，</p>
<h1 id="重映射按键和鼠标按钮"><a href="#重映射按键和鼠标按钮" class="headerlink" title="重映射按键和鼠标按钮"></a>重映射按键和鼠标按钮</h1><p>下面描述的autohotkey 重映射功能通常不如直接通过windows 注册表进行映射那么直接有效<br>对于每种方法的优点和缺点，请参阅注册表重映射</p>
<h3 id="重映射键盘和鼠标"><a href="#重映射键盘和鼠标" class="headerlink" title="重映射键盘和鼠标"></a>重映射键盘和鼠标</h3><p>内置重映射功能的语法为 OriginKey::DestinationKey。例如, 只包含下面这行内容的 脚本 会将 “a” 键重映射成 “b” 键:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a::b</span><br></pre></td></tr></table></figure>

<p>上面的例子没有改变 b 键自身的功能，b 键会继续发送b 的键击，除非把它重映射成其他功能，就像下面例子中演示的那样</p>
<p>上述例子中使用小写字母，在大多数情况下建议这么做，因为它也会映射相应的大写字母，<br>即在capslock 打开或shift 键被按住时会发送大写形式，与之相比，在右边使用大写字母会强制发送大写形式，<br>例如, 下面的代码行在您输入 “a” 或 “A” 时都会产生大写字母 B (只要 Capslock 是关闭的):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a::B</span><br></pre></td></tr></table></figure>

<p>鼠标重映射 要映射鼠标，请使用和映射键盘相同的方法，例如</p>
<p>MButton::Shift  把鼠标中键映射成 Shift 键.<br>XButton1::LButton 把第四个鼠标按钮映射成鼠标左键.<br>RAlt::RButton 把右 Alt 映射成鼠标右键.</p>
<h4 id="其他有用的映射"><a href="#其他有用的映射" class="headerlink" title="其他有用的映射"></a>其他有用的映射</h4><p>Capslock::Ctrl  把 Capslock 映射成 Control 键. 要保留打开和关闭 Capslock 的功能，还需添加重映射 +Capslock::Capslock（这样，当您按住 shift 键并按下 Capslock 后就可以切换 Capslock 的状态了）。<br>XButton2::^LButton  把第五个鼠标按钮 (XButton2) 映射成 Control-LeftClick.<br>RAlt::AppsKey 把右 Alt 键映射成 Apps 键 (这是打开上下文菜单的按键).<br>RCtrl::RWin 把右 Control 键映射成右 Windows 键.<br>Ctrl::Alt 把左右 Control 键映射成 Alt 键. 但是, 请参阅 alt-tab 的问题.<br>^x::^c  把 Control-X 映射成 Control-C. 它也会让 Control-Alt-X 产生 Control-Alt-C, 等等.<br>RWin::Return  让右 Windows 键简单地执行 return 来禁用它.</p>
<p>您可以尝试执行这里的每个例子，把它们复制到新文本文件，例如 remap.ahk 然后运行这个文件</p>
<p>请参阅按键列表，来了解按键和鼠标按钮名称的完整列表</p>
<h2 id="备注-1"><a href="#备注-1" class="headerlink" title="备注"></a>备注</h2><p>使用#ifwinactive&#x2F;exist 指令可以让重映射仅在指定的窗口中有效，例如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#IfWinActive ahk_class Notepad</span><br><span class="line">a::b  ; 让 &#x27;a&#x27; 键到 &#x27;b&#x27; 键的映射仅在记事本中有效.</span><br><span class="line">#IfWinActive  ; 这里让后续的重映射和热键对所有窗口生效.</span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
      <div id="reword-out">
        <div id="reward-btn">
          打赏
        </div>
      </div>
      
    </div>
    

    <!-- copyright -->
    
    <div class="declare">
      <ul class="post-copyright">
        <li>
          <i class="ri-copyright-line"></i>
          <strong>版权声明： </strong>
          
          本博客所有文章除特别声明外，著作权归作者所有。转载请注明出处！
          
        </li>
      </ul>
    </div>
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        分享
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=http://example.com/2023/05/21/20230521-AutoHotKey%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B%E5%92%8C%E8%84%9A%E6%9C%AC%E6%8E%A8%E8%8D%90/" alt="微信分享二维码">
    </div>
</div>

<div id="share-mask"></div>  
    </footer>
  </div>

   
  <nav class="article-nav">
    
      <a href="/2023/05/21/20230521-%E5%A6%82%E4%BD%95%E9%80%89%E6%8B%A9%E4%B8%80%E4%B8%AACPU/" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">
          
            20230521-如何选择一个CPU
          
        </div>
      </a>
    
    
      <a href="/2023/05/20/20230520-%E6%BF%80%E6%B4%BBwin10%E5%92%8Coffice%E6%96%B9%E6%B3%95/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">20230520-激活win10和office方法</div>
      </a>
    
  </nav>

  
   
    
    <script src="https://cdn.staticfile.org/twikoo/1.4.18/twikoo.all.min.js"></script>
    <div id="twikoo" class="twikoo"></div>
    <script>
        twikoo.init({
            envId: ""
        })
    </script>
 
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2015-2023
        <i class="ri-heart-fill heart_icon"></i> TeX_baitu
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>访问人数:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>浏览次数:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="TeX_baitu blog"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags/%E6%97%85%E8%A1%8C/">旅行</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" target="_blank" rel="noopener" href="http://shenyu-vip.lofter.com">摄影</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/friends">友链</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/2019/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="搜索">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->
 
<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: ".tocbot",
    contentSelector: ".article-entry",
    headingSelector: "h1, h2, h3, h4, h5, h6",
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: "main",
    positionFixedSelector: ".tocbot",
    positionFixedClass: "is-position-fixed",
    fixedSidebarOffset: "auto",
  });
</script>

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    

  </div>
</body>

</html>