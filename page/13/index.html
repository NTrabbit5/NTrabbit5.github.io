<!DOCTYPE html>


<html lang="zh-CN">
  

    <head>
      <meta charset="utf-8" />
        
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title> TeX_baitu blog</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      
<link rel="stylesheet" href="/css/fonts/remixicon.css">

      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    </head>
  </html>
</html>


<body>
  <div id="app">
    
      
    <main class="content on">
      


<script src="https://cdn.staticfile.org/typed.js/2.0.12/typed.min.js"></script>


<!-- Subtitle -->

  <script>
    try {
      var typed = new Typed("#subtitle", {
        strings: ['面朝大海，春暖花开', '愿你一生努力，一生被爱', '想要的都拥有，得不到的都释怀'],
        startDelay: 0,
        typeSpeed: 200,
        loop: true,
        backSpeed: 100,
        showCursor: true
      });
    } catch (err) {
      console.log(err)
    }
  </script>
  
<div id="main">
  <section class="outer">
  
  
  

<div class="notice" style="margin-top:50px">
    <i class="ri-heart-fill"></i>
    <div class="notice-content" id="broad"></div>
</div>
<script type="text/javascript">
    fetch('https://v1.hitokoto.cn')
        .then(response => response.json())
        .then(data => {
            document.getElementById("broad").innerHTML = data.hitokoto;
        })
        .catch(console.error)
</script>

<style>
    .notice {
        padding: 20px;
        border: 1px dashed #e6e6e6;
        color: #969696;
        position: relative;
        display: inline-block;
        width: 100%;
        background: #fbfbfb50;
        border-radius: 10px;
    }

    .notice i {
        float: left;
        color: #999;
        font-size: 16px;
        padding-right: 10px;
        vertical-align: middle;
        margin-top: -2px;
    }

    .notice-content {
        display: initial;
        vertical-align: middle;
    }
</style>
  
  <article class="articles">
    
    
    
    
    <article
  id="post-20220818-mutoolpdf简介"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/08/18/20220818-mutoolpdf%E7%AE%80%E4%BB%8B/"
    >20220818-mutoolpdf简介</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/08/18/20220818-mutoolpdf%E7%AE%80%E4%BB%8B/" class="article-date">
  <time datetime="2022-08-18T04:18:36.000Z" itemprop="datePublished">2022-08-18</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>MuPDF Command Line Tools<br>MuPDF 官网</p>
<p>MuPDF 的命令行工具都放在了一个命令文件中：mutool.exe</p>
<p>mutool draw 将页面转为图像等文件<br>draw 命令将文档渲染成图片，转换其他格式的矢量图或提取文本内容。</p>
<pre><code>mutool draw [options] file [pages]
</code></pre>
<p>支持的输入格式：pdf, xps, cbz, and epub<br>支持的输出格式：</p>
<ul>
<li>图像：pbm, pgm, ppm, pam, png, tga, pwg, pcl</li>
<li>矢量：svg, pdf, and debug trace (as xml)</li>
<li>文本：plain text, html, and structured text (as xml)</li>
</ul>
<p>Options:<br>-p password<br>文件是加密的话，用以输入密码。</p>
<p>-o output<br>指定输出的文件名，文件名可以嵌入指示页码（例如：“页面%d.PNG”），<br>并支持Prtf修改器，例如“%03d”。如果没有指定输出，输出将转到 stdout。从文件名可推断出输出格式。</p>
<p>-F format<br>指定输出格式，一般在输出到 stdout 时使用。</p>
<p>-R angle<br>指定顺时针旋转角度。</p>
<p>-r resolution<br>指定的分辨率。默认为 72 dpi。</p>
<p>-w width<br>指定页面宽度</p>
<p>-h height<br>指定页面高度</p>
<p>-f<br>精确匹配；在匹配指定的宽度&#x2F;高度时忽略纵横比。</p>
<p>-B bandheight<br>本设置这在渲染过程中使用较少的内存。仅兼容PAM、PGM、PPM、PNM和PNG输出格式。和 md5 checksumming may 不能同时使用。</p>
<p>-W width<br>EPUB布局中的页面宽度。</p>
<p>-H height<br>EPUB布局中的页面高度。</p>
<p>-S size<br>EPUB布局中的字体大小</p>
<p>-U filename<br>指定用于EPUB布局的用户自定义的CSS样式表</p>
<p>-c colorspace<br>指定渲染的色彩空间。支持的色彩空间：单色、灰度、Grayα、RGB、RGBALPHA、CMYK、CMYKALPHA。允许的缩写：M，G，GA，RGBA，CMYKA。默认值是基于输出格式选择的。</p>
<p>-G gamma<br>伽马校正，0.7 或 1.4 常用于亮色或暗色文本的渲染。</p>
<p>-I<br>反转颜色</p>
<p>-s [mft5]<br>显示各种信息：</p>
<ul>
<li>m 用于字形缓存和总内存使用，</li>
<li>f 用于页面特性，例如页面是灰度级还是颜色，</li>
<li>t 用于每页渲染时间以及统计信息，</li>
<li>5 用于 md5 渲染图像的校验和，这些校验和可用于检查渲染是否已经改变。</li>
</ul>
<p>-A bits<br>指定反锯齿位数。默认值为 8。</p>
<p>-D<br>禁止显示列表的使用。会导致速度减慢，但可减少内存的使用量。</p>
<p>-i<br>忽略错误。</p>
<p>-L<br>低内存模式（避免缓存对象在每个页面后清除缓存）。</p>
<p>-P<br>同时进行解释和渲染。</p>
<p>pages<br>逗号分隔的页码和范围列表（例如：1,5，10-15）。如果没有指定页面，则将呈现所有页面。</p>
<p>mutool convert 用于将文档转换成其他格式<br>mutool trace 这是一个调试工具，用于退踪打印图形的调用情况。<br>这些工具专门用于处理 PDF 文件:</p>
<p>mutool show 显示 PDF 文件中内部对象的工具。<br>mutool extract 提取图像和嵌入字体资源。<br>mutool clean 重写PDF文件。用于修复损坏的文件，或使PDF文件可编辑。<br>mutool merge 将多个输入文件合并为一个新的 PDF 文件<br>mutool create 从文本文件创建一个新的PDF文件。<br>mutool portfolio Manipulate PDF portfolios.<br>最后，有一个工具可以做任何你能想象到的事情:</p>
<p>mutool run 一种运行JavaScript程序的工具，可以访问MUPDF库函数。</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-20220817-PDF文件处理提示"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/08/17/20220817-PDF%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86%E6%8F%90%E7%A4%BA/"
    >20220817-PDF文件处理提示</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/08/17/20220817-PDF%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86%E6%8F%90%E7%A4%BA/" class="article-date">
  <time datetime="2022-08-17T13:57:24.000Z" itemprop="datePublished">2022-08-17</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>PDF文件处理小提示</p>
<ol>
<li>获取PDF元数据，需要使用poppler库下面的pdfinfo命令：</li>
</ol>
<p>D:&gt;pdfinfo test.pdf<br>Producer:       Feisty Duck Digital Delivery Service<br>CreationDate:   08&#x2F;19&#x2F;13 17:40:44<br>ModDate:        08&#x2F;19&#x2F;13 17:40:44<br>Tagged:         no<br>Pages:          367<br>Encrypted:      no<br>Page size:      535.68 x 697.44 pts<br>File size:      2101334 bytes<br>Optimized:      no<br>PDF version:    1.4<br>2. 查看PDF中所使用到的字体，需要使用poppler库下面的pdffonts命令：</p>
<p>D:&gt;pdffonts test.pdf<br>name                                 type              emb sub uni object ID</p>
<hr>
<p>FZPJCT+FreeSans                      CID TrueType      yes yes yes      1  0<br>BKUKSQ+NimbusSanL-Regu               Type 1            yes yes no     755  0<br>QRYPKX+CMSY10                        Type 1            yes yes no     762  0<br>ZLHPUU+CenturySchL-Roma              Type 1            yes yes no     763  0<br>ZCSUFP+CenturySchL-Bold              Type 1            yes yes no     764  0<br>[none]                               Type 3            yes no  no     765  0<br>KSECLT+TradeGothic-CondEighteen      Type 1C           yes yes no       8  0<br>WLDBEZ+CenturySchL-Ital              Type 1            yes yes no     768  0<br>JGPJSJ+NimbusSanL-Bold               Type 1            yes yes no     773  0<br>KINSVY+CenturySchL-BoldItal          Type 1            yes yes no     819  0<br>UMGSAF+CMR10                         Type 1            yes yes no     820  0<br>GNTWCJ+CMR7                          Type 1            yes yes no     821  0<br>MASRIW+CMMI10                        Type 1            yes yes no     824  0<br>JEHZIM+CMMI7                         Type 1            yes yes no     861  0<br>GBDQPA+CMSY7                         Type 1            yes yes no     862  0<br>[none]                               Type 3            yes no  no     935  0<br>[none]                               Type 3            yes no  no    1086  0<br>[none]                               Type 3            yes no  no    1110  0<br>YJJVSC+Helvetica                     Type 1C           yes yes no    2043  0<br>[none]                               Type 3            yes no  no    1522  0</p>
<ol start="3">
<li>抽取PDF中的文本，使用poppler中的pdftotext：</li>
</ol>
<p>pdftotext test.pdf<br>4. 将PDF转换为PS&#x2F;EPS，使用poppler中的pdftops：</p>
<p>pdftops test.pdf      # to PS<br>pdftops -eps test.pdf # to EPS<br>5. 将PDF转换为JPEG&#x2F;PNG，使用poppler中的pdfimages或MuPDF中的mudraw（强烈推荐）：</p>
<p>pdfimages -f 1 -j test.pdf test       # 转换为jpg，但在Windows下有bug<br>mudraw -r 600 -o test-%d.png test.pdf # 转换为PNG，分辨率为600<br>6. 将PDF中嵌入的字体和图片提取出来，使用MuPDF中的mutool（旧版本为mubusy）：</p>
<p>mutool extract test.pdf<br>7. 解压PDF，需要使用上面的工具，这对开发者优化PDF输出很有帮助：</p>
<p>mutool clean -d test.pdf<br>8. 抽取PDF中的某一页，使用pdftk操作：</p>
<p>pdftk test.pdf cat 1-2 output z.pdf # 抽取1-2页，保存为z.pdf<br>9. 翻转PDF中的某一页，使用pdftk操作：</p>
<p>pdftk test.pdf cat 4-4east output z.pdf<br>工具下载地址：</p>
<p><a href="ftp://ftp.foolabs.com/pub/xpdf/xpdfbin-win-3.04.zip">ftp://ftp.foolabs.com/pub/xpdf/xpdfbin-win-3.04.zip</a> （TeX Live中自带）<br><a target="_blank" rel="noopener" href="http://www.mupdf.com/downloads/mupdf-1.4-windows.zip">http://www.mupdf.com/downloads/mupdf-1.4-windows.zip</a><br>PDFtk - The PDF Toolkit （注意，现在的PDFtk提供了一个GUI界面，但是需要注册，可以选用第三方的，比如Homepage, PDF Tools from Dirk Paehl）</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-20220812-pdftocairo"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/08/12/20220812-pdftocairo/"
    >20220812-pdftocairo</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/08/12/20220812-pdftocairo/" class="article-date">
  <time datetime="2022-08-12T06:55:37.000Z" itemprop="datePublished">2022-08-12</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>[TOC]</p>
<h2 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h2><h2 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h2><h2 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h2><h2 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h2> 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-20220812-powershell管道操作"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/08/12/20220812-powershell%E7%AE%A1%E9%81%93%E6%93%8D%E4%BD%9C/"
    >20220812-powershell管道操作</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/08/12/20220812-powershell%E7%AE%A1%E9%81%93%E6%93%8D%E4%BD%9C/" class="article-date">
  <time datetime="2022-08-12T01:22:56.000Z" itemprop="datePublished">2022-08-12</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>无论是在Linux中写Bash脚本还是在Window上写PowerShell，管道符”|“是一个非常有用的工具。它提供了将前一个命令的输出作为下一个命令的输入的功能。在数据处理中，我们也可以使用管道符对数据进行各种操作。</p>
<h2 id="Import-amp-Export导入导出"><a href="#Import-amp-Export导入导出" class="headerlink" title="Import&amp;Export导入导出"></a>Import&amp;Export导入导出</h2><p>先说导入导出是为了能够为接下来的数据处理准备数据。在PowerShell中我们也可以通过各种Get-XXX命令获得各种各样需要的数据，但是并不是所有操作系统和各个版本的PowerShell都支持某个命令的。比如Get-Volume命令，用于获得每个磁盘的信息，但是这个命令不能在Win7下运行，只能在Win8或Win2012Server下运行。</p>
<p>最常见，最简单的外部数据源就是CSV文件了。我们可以使用Export-Csv命令将PowerShell中的对象转换为CSV格式，持久化到磁盘上。比如我们将当前的所有进程信息导出为CSV文件，命令为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Get</span>-<span class="title class_">Process</span> | <span class="title class_">Export</span>-<span class="title class_">Csv</span> <span class="attr">C</span>:\test.<span class="property">csv</span> -<span class="title class_">Encoding</span> <span class="title class_">Unicode</span></span><br></pre></td></tr></table></figure>



<p>（注意，如果是有中文内容建议设置Encoding为Unicode或者UTF8）</p>
<p>Import-Csv命令是导入外部的CSV文件到内存。比较刚才导出的CSV文件，我们接下来要对这个文件进行处理。我们可以将文件的内容保存到变量$data中。命令为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$data=<span class="title class_">Import</span>-<span class="title class_">Csv</span> <span class="attr">C</span>:\test.<span class="property">csv</span> -<span class="title class_">Encoding</span> <span class="title class_">Unicode</span></span><br></pre></td></tr></table></figure>



<p>当然，我们也可以先进行类型转换，然后保存。命令为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$data | <span class="title class_">ConvertTo</span>-<span class="title class_">Csv</span> | <span class="title class_">Out</span>-<span class="title class_">File</span> <span class="attr">C</span>:\test.<span class="property">csv</span> -<span class="title class_">Encoding</span> utf8</span><br></pre></td></tr></table></figure>



<h2 id="Sorting排序"><a href="#Sorting排序" class="headerlink" title="Sorting排序"></a>Sorting排序</h2><p>前面我们已经将CSV的内容载入到$data变量中了，那么如果我们要按照某一个字段排序，可以使用Sort-Object命令。</p>
<p>比如我们要Name这个字段排序，并输出排序后的结果，那么命令为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$data | <span class="title class_">Sort</span>-<span class="title class_">Object</span> <span class="title class_">Name</span></span><br></pre></td></tr></table></figure>



<p>也可以简写为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$data | <span class="title class_">Sort</span> <span class="title class_">Name</span></span><br></pre></td></tr></table></figure>



<p>如果是需要多个字段排序，那么可以将字段列在后面，字段之间用逗号隔开。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$data | <span class="title class_">Sort</span> <span class="title class_">Name</span>,<span class="title class_">Handles</span></span><br></pre></td></tr></table></figure>



<p>如果是逆向排序，那么需要在字段后面加参数-Descending</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$data | <span class="title class_">Sort</span> <span class="title class_">Name</span> –<span class="title class_">Descending</span></span><br></pre></td></tr></table></figure>



<h2 id="Selecting选取"><a href="#Selecting选取" class="headerlink" title="Selecting选取"></a>Selecting选取</h2><p>选取相当于SQL中的SELECT命令。对应的PowerShell命令是Select-Object，可以简写为Select。该命令后面跟上要选取的列名即可。如果是要选取所有的列，也可以使用*表示。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$data | select <span class="title class_">Name</span>,<span class="variable constant_">VM</span></span><br></pre></td></tr></table></figure>



<p>选取所有列，那么命令就是：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$data | select *</span><br></pre></td></tr></table></figure>



<p>如果是只选取前面几条数据，那么可以使用-First参数。比如我们按Handles排序，只查看头10条进程记录的名字和Handles。命令为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$data | sort <span class="title class_">Handles</span> | select <span class="title class_">Handles</span>,<span class="title class_">Name</span> -<span class="title class_">First</span> <span class="number">10</span></span><br></pre></td></tr></table></figure>



<p>另外还有参数-Last选取的是最后几条记录，-Skip可以选择跳过一定记录。</p>
<h2 id="Calculate计算列"><a href="#Calculate计算列" class="headerlink" title="Calculate计算列"></a>Calculate计算列</h2><p>在SELECT的时候，我们可以使用函数对其中的列进行运算，使用的语法是：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@&#123; </span><br><span class="line">  n=<span class="string">&#x27;New Column Name&#x27;</span>; </span><br><span class="line">  e=&#123; $_.<span class="property">xxxCalc</span> &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>其中的$_就是表示当前的记录。</p>
<p>比如VM列记录的是以Byte为单位的数据，我们先新建一列名为”VM(MB)”,其值是换算成MB的结果，那么我们可以写为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$data | select <span class="title class_">Name</span>,<span class="variable constant_">VM</span>,@&#123;n=<span class="string">&quot;VM(MB)&quot;</span>;e=&#123;$_.<span class="property">VM</span>/1MB&#125;&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Measuring度量"><a href="#Measuring度量" class="headerlink" title="Measuring度量"></a>Measuring度量</h2><p>说度量可能有点不是很清晰，其实就是对应SQL中的聚合函数。比如 SUM, Max,Min之类的，需要使用Measure-Object命令。比如要查看有多少个程序，最小的Handles和最大的Handles，那么命令是：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$data | <span class="title class_">Measure</span>-<span class="title class_">Object</span> -<span class="title class_">Property</span> <span class="title class_">Handles</span> -<span class="title class_">Minimum</span> -<span class="title class_">Maximum</span></span><br></pre></td></tr></table></figure>



<p>既然说到SQL中的聚合函数，那么自然就会想到另外一个关键字Group By。在PowerShell中也有对应的命令Group-Object。如果我们想要按进程的Name进行分组，查看每个进程名对应的VM总大小。那么我们可以先按Name进行Group：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$data | <span class="title class_">Group</span>-<span class="title class_">Object</span> <span class="title class_">Name</span></span><br></pre></td></tr></table></figure>



<p>这时我们可以看到系统返回的结果有3列：Count,Name,Group。而我们要进行聚合的VM值是在Group中。这时需要用到前面提到的Select命令。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$data | <span class="title class_">Group</span>-<span class="title class_">Object</span> <span class="title class_">Name</span> | select <span class="title class_">Name</span>,<span class="title class_">Count</span>,@&#123;n=<span class="string">&quot;TotalVM&quot;</span>;e=&#123;($_.<span class="property">Group</span> | <span class="title class_">Measure</span>-<span class="title class_">Object</span> -<span class="title class_">Property</span> <span class="variable constant_">VM</span> -<span class="title class_">Sum</span>).<span class="property">Sum</span>&#125;&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Filter过滤"><a href="#Filter过滤" class="headerlink" title="Filter过滤"></a>Filter过滤</h2><p>过滤相当于SLQ中的Where语句，在PowerShell中使用Where-Object命令。可以简写为Where，甚至可以简写为”?”。在普通程序里面我们遇到的比较运算和逻辑运算在PowerShell中有所不同，是这样的参数：</p>
<table>
<thead>
<tr>
<th align="left">Comparison</th>
<th align="left">Case-InSensitive</th>
<th align="left">Case-sensitive</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Equality</td>
<td align="left">-eq</td>
<td align="left">-ceq</td>
</tr>
<tr>
<td align="left">Inequality</td>
<td align="left">-ne</td>
<td align="left">-cne</td>
</tr>
<tr>
<td align="left">Greater than</td>
<td align="left">-gt</td>
<td align="left">-cgt</td>
</tr>
<tr>
<td align="left">Less than</td>
<td align="left">-lt</td>
<td align="left">-clt</td>
</tr>
<tr>
<td align="left">Greater than or equal to</td>
<td align="left">-ge</td>
<td align="left">-cge</td>
</tr>
<tr>
<td align="left">Less than or equal to</td>
<td align="left">-le</td>
<td align="left">-cle</td>
</tr>
<tr>
<td align="left">Wildcard equality</td>
<td align="left">-like</td>
<td align="left">-clike</td>
</tr>
</tbody></table>
<p>-and 和-or用于逻辑运算。</p>
<p>仍然以前面load的$data为例，我们要查看以W开头的进程的Handles和Name，那么命令为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$data | ?&#123; $_.<span class="property">Name</span> -like <span class="string">&#x27;W*&#x27;</span>&#125;| select <span class="title class_">Handles</span>,<span class="title class_">Name</span></span><br></pre></td></tr></table></figure>



<p>如果是多个条件，既要以w开头，还要VM大于100M的进程，那么命令为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$data | ?&#123; $_.<span class="property">Name</span> -like <span class="string">&#x27;W*&#x27;</span> -and $_.<span class="property">VM</span> -gt 100MB&#125;| select <span class="title class_">Handles</span>,<span class="title class_">Name</span>,<span class="variable constant_">VM</span></span><br></pre></td></tr></table></figure>



<h2 id="Enumeration枚举"><a href="#Enumeration枚举" class="headerlink" title="Enumeration枚举"></a>Enumeration枚举</h2><p>枚举相当于C#中的Foreach函数，或者说是SQL中的游标，对于每一行数据，都进行一个运算或者函数处理。在PowerShell中对应的命令是ForEach-Object，可以简写为ForEach，还可以进一步简写为”%“。</p>
<p>比如我们要将VM改为MB为单位，可以对每一行数据进行运算：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$data | % &#123;$_.<span class="property">VM</span>=$_.<span class="property">VM</span>/1MB&#125;</span><br></pre></td></tr></table></figure>



<p>运行该命令后我们再查看$data就会发现VM列已经改变了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$data | select <span class="title class_">Name</span>,<span class="variable constant_">VM</span></span><br></pre></td></tr></table></figure>



<p>另外对于Foreach命令，还有两个比较有用的参数-Begin –End,用于在做For循环之前调用和循环结束后调用。</p>
<p>比如我们想把某一列写入一个文件，我们可以在-Begin时创建文件，记录开始的时间，然后Foreach中Append内容到文件，最后把结束时间写入：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$data | % -<span class="title class_">Begin</span> &#123; <span class="title class_">Get</span>-<span class="title class_">Date</span> | <span class="title class_">Out</span>-<span class="title class_">File</span> <span class="attr">C</span>:\test.<span class="property">txt</span> &#125; -<span class="title class_">Process</span> &#123; $_.<span class="property">Name</span> | <span class="title class_">Out</span>-<span class="title class_">File</span> <span class="attr">C</span>:\test.<span class="property">txt</span> -<span class="title class_">Append</span>&#125; -<span class="title class_">End</span> &#123; <span class="title class_">Get</span>-<span class="title class_">Date</span> | <span class="title class_">Out</span>-<span class="title class_">File</span> <span class="attr">C</span>:\test.<span class="property">txt</span> -<span class="title class_">Append</span>&#125;</span><br></pre></td></tr></table></figure>


 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-20220808-PhotoShop插件编写"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/08/08/20220808-PhotoShop%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/"
    >20220808-PhotoShop插件编写</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/08/08/20220808-PhotoShop%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/" class="article-date">
  <time datetime="2022-08-08T07:28:20.000Z" itemprop="datePublished">2022-08-08</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1844y177F3">https://www.bilibili.com/video/BV1844y177F3</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/59713896">https://zhuanlan.zhihu.com/p/59713896</a></p>
<p>关于我对<br>圆角编辑脚本插件，CornerEditor 如下图</p>
<p>这个插件可以帮助你快速的编辑图层的圆角，随便改数值即可。</p>
<p>这个脚本就是有一个jsx的文件组成的，jsx 是adobe对javascript 的扩展语言，又叫做ExtensionScript 它是对js语言的一种扩展，提供了访问宿主（photoshop）相关功能接口的特性。</p>
<h2 id="初识ps-脚本"><a href="#初识ps-脚本" class="headerlink" title="初识ps 脚本"></a>初识ps 脚本</h2><p>app.beep() photoshop 执行播放提示音效命令</p>
<p>app.activeDocument.close()  photoshop的当前文档执行关闭命令</p>
<p>app.app.activeDocument.activeLayer.alpha&#x3D;50 photo 的当前文档的当前图层的透明度设置为50</p>
<p>app.activeDocument.selection.feather(10) photoshop 的当前文档的当前选取执行羽化命令，羽化值为10</p>
<p>编写脚本的快捷键</p>
<hr>
<p>对photoshop 插件开发的认识</p>
<p>第一种 脚本插件</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/59713896">https://zhuanlan.zhihu.com/p/59713896</a></p>
<hr>
<p>photoshop 脚本参考文档中文翻译</p>
<p>图层与图层组</p>
<p>layer 与artlayer 都是图层，在Photoshopcc2015 以后是等效的概念</p>
<p>而在使用上有一个区别：</p>
<p>在 Document.artLayers 中的 artLayers 是文档根目录的图层的集合。<br>而 Document.layers 是所有图层和图层组的集合。</p>
<p>而画板是一个特殊的图层组。</p>
<p>比如下面这个文档：</p>
<p>查看图片</p>
<p>通过 app.activeDocument.artLayers[0] 和 [1] 可以获得图层 5 和图层 4，而 app.activeDocument.layers 除此之外还有 [2] 可以获得画板 1。</p>
<p>artLayer 对象</p>
<p>kind LayerKind</p>
<p>图层类型</p>
<p>LayerKind<br>LayerKind.NORMAL  普通<br>LayerKind.TEXT  文本<br>LayerKind.SMARTOBJECT 智能对象<br>LayerKind.SOLIDFILL 填充形状<br>LayerKind.VIDEO 视频<br>LayerKind.LAYER3D 3D 图层<br>填充或调整图层：<br>LayerKind.BLACKANDWHITE 黑白<br>LayerKind.BRIGHTNESSCONTRAST  明度对比<br>LayerKind.CHANNELMIXER  通道混合器<br>LayerKind.COLORBALANCE  色彩平衡<br>LayerKind.COLORLOOKUP 色彩查找<br>LayerKind.CURVES  曲线<br>LayerKind.EXPOSURE  曝光<br>LayerKind.GRADIENTFILL  渐变填充<br>LayerKind.GRADIENTMAP 渐变映射<br>LayerKind.HUESATURATION 色相饱和度<br>LayerKind.INVERSION 反相<br>LayerKind.PATTERNFILL 图案填充<br>LayerKind.PHOTOFILTER 照片滤镜<br>LayerKind.POSTERIZE 色调分离<br>LayerKind.SELECTIVECOLOR  可选颜色<br>LayerKind.THRESHOLD 阈值<br>LayerKind.LEVELS  色阶<br>LayerKind.VIBRANCE  自然饱和度</p>
<p>opacity number 不透明度，图层的不透明属性</p>
<p>fillOpacity number 填充不透明度，图层的填充属性</p>
<p>visible boolean 可视性</p>
<p>linkedLayers ArtLayer 或 LayerSet 数组<br>图层链接，只读。</p>
<p>查看图片</p>
<p>itemIndex number<br>内部索引号。图层在 PhotoShop 内部的的索引号，无关图层组嵌套。序号从下至上递增，背景图层为 1。图层组与图层相同，也有一个索引号。</p>
<p>allLocked boolean<br>图层锁定全部。true 为锁定。完全不能选中和编辑图层。</p>
<p>查看图片</p>
<p>pixelsLocked boolean<br>图层像素锁定。true 为锁定。无法编辑图层像素，但可以移动图层位置。</p>
<p>positionLocked boolean<br>图层位置锁。true 为锁定。无法移动图层位置。</p>
<p>查看图片</p>
<p>transparentPixelsLocked boolean<br>图层透明度锁。true 为锁定。无法改变图层透明度。</p>
<p>查看图片</p>
<p>grouped boolean<br>剪贴蒙版组，设置为 true ，当前图层就为把下一个图层作为剪切蒙版。</p>
<p>查看图片</p>
<p>bounds UnitValue 数组<br>图层区域。只读。[0,1,2,3] 分别是 0:左侧左边距 ，1:顶侧顶边距 ，2:右侧左边距 ，3:底侧顶边距。</p>
<p>查看图片</p>
<p>boundsNoEffects UnitValue 数组<br>不包括样式（比如阴影）的图层区域。</p>
<p>filterMaskDensity double<br>滤镜蒙版 浓度（0.0 ~100.0）。</p>
<p>查看图片</p>
<p>filterMaskFeather double<br>滤镜蒙版 羽化（0.0 ~ 250.0）。</p>
<p>layerMaskDensity double<br>图层蒙版 浓度（0.0 ~100.0）。</p>
<p>layerMaskFeather double<br>图层蒙版 羽化（0.0 ~ 250.0）。</p>
<p>vectorMaskDensity double<br>矢量蒙版 浓度（0.0 ~100.0）。</p>
<p>vectorMaskFeather double<br>矢量蒙版 羽化（0.0 ~ 250.0）。</p>
<p>isBackgroundLayer boolean<br>是否为背景图层，为这把图层转换为背景图层，并把图层放到最底层，如果已有背景图层，设置此属性会失败。</p>
<p>查看图片</p>
<p>textItem TextItem<br>文本项。</p>
<p>blendMode BlendMode<br>混合模式。</p>
<p>xmpMetadata xmpMetadata<br>XMP 元数据。</p>
<p>方法<br>adjustBrightnessContrast( 亮度, 对比度 )<br>调整亮度、对比度。相当于“使用旧版”的亮度&#x2F;对比度调节。（范围： -100~100）</p>
<p>查看图片</p>
<p>adjustColorBalance( [阴影], [中间调], [高光] , 保持明度 )<br>调整色彩平衡。前三个参数放入色彩平衡值的数组，分别调整阴影、中间调、高光的平衡，最后一个参数为真即为保持明度。（范围： -100~100）</p>
<p>app.activeDocument.artLayers[0].adjustColorBalance([0,0,0], [2,-23,22], [0,0,0], true)<br> 查看图片</p>
<p>adjustCurves( [曲线坐标数组] )<br>图层的曲线调节。参数是一个数组，其中可以有最多 14 组坐标，表示曲线的点。每组坐标 [x,y] 的 x 对应曲线面板中的输入，y 对应输出。</p>
<p>app.activeDocument.artLayers[0].adjustCurves([[0,0], [149,58], [255,255]])<br>查看图片</p>
<p>adjustLevels( 输入开始位置, 输入结束位置, 输入 Gamma 值, 输出开始位置, 输出结束位置 )<br>调整色阶。</p>
<p>app.activeDocument.artLayers[0].adjustLevels(37, 255, 0.46, 63, 174)<br> 查看图片</p>
<p>applyAddNoise( 数量, 分布方式, 单色 )<br>添加杂色（滤镜）。数量参数范围： 0~400，分布方式使用常数 NoiseDistribution.GAUSSIAN 和 NoiseDistribution.UNIFORM，分别代表高斯分布和平均分布，单色为真时产生无单色杂色。</p>
<p>查看图片</p>
<p>applyAverage()<br>应用“模糊-平均”滤镜。</p>
<p>applyBlur()<br>应用“模糊-模糊”滤镜。</p>
<p>applyClouds ()<br>应用“渲染-云彩”滤镜。</p>
<p>applyCustomFilter( [特征值数组], 缩放, 位移 )<br>应用“其他-自定”滤镜。</p>
<p>查看图片</p>
<p>applyDeInterlace( 消除方式, 创建新场方式 )<br>应用“视频-逐行…” 滤镜</p>
<p>消除方式：</p>
<p>EliminateFields.EVENFIELDS  偶数行<br>EliminateFields.ODDFIELDS 奇数行<br>创建新场方式：</p>
<p>CreateFields.DUPLICATION  复制<br>CreateFields.INTERPOLATION  插值<br>查看图片</p>
<p>applyDespeckle()<br>应用”杂色-去斑”滤镜</p>
<p>applyDifferenceClouds()<br>应用“渲染-分层彩云”滤镜。</p>
<p>applyDiffuseGlow( 粒度,  发光量,  清除数量 )<br>应用”滤镜库-扭曲-扩撒亮光”滤镜。</p>
<p>查看图片</p>
<p>autoContrast()<br>自动对比度。</p>
<p>autoLevels()<br>自动色调。</p>
<p>clear()<br>清除图层内容，如果是形状图层将会删除本图层，如果是智能对象将会报“无法删除”错误。</p>
<p>copy( 混合 )<br>复制图层内容。混合参数为真会复制所有图层可见内容。</p>
<p>cut()<br>剪切图层。</p>
<p>desaturate()<br>去色。</p>
<p>duplicate( 相对图层\组, 相对位置 )<br>创建一个图层副本， 可不传入参数，将副本放在原件之后。此外还可以用参数控制创建的副本在图层面板中的位置，新的副本创建在相对图层\组的相对位置。</p>
<p>ElementPlacement.INSIDE 插入图层组<br>ElementPlacement.PLACEATBEGINNING 图层组首位<br>ElementPlacement.PLACEATEND 图层组末位<br>ElementPlacement.PLACEBEFORE  之前<br>ElementPlacement.PLACEAFTER 之后<br>app.activeDocument.artLayers[0].duplicate(app.activeDocument.layers[1], ElementPlacement.INSIDE)</p>
<p>equalize 色调均化</p>
<p>invert()<br>反相。</p>
<p>link( 连接目标 )<br>与连接目标创建图层连接，连接目标可以是图层或图层组。</p>
<p>app.activeDocument.artLayers[0].link( app.activeDocument.artLayers[1] )<br> 查看图片</p>
<p>merge()<br>向下合并图层，返回值为合并后的图层。</p>
<p>mixChannels( [输出通道数组] , 单色 )<br>通道混合器。第一个参数是输出通道数组：[[红] , [绿] , [蓝]]（当图像是 CMYK 则是相应的 CMYK 通道），没一个通道也是一个数组，分别是红色、绿、蓝和常数。如果单色参数为真，就只需一组灰度通道参数。</p>
<p>&#x2F;&#x2F;非单色<br>app.activeDocument.artLayers[0].mixChannels([[100, 100,110,115], [100, 100,110,115], [100, 100,110,115] ],flase)<br>&#x2F;&#x2F; 单色：<br>app.activeDocument.artLayers[0].mixChannels([[100, 100,110,115]],true)<br> 查看图片</p>
<p>move( 相对图层\组, 相对位置 )<br>移动图层在面板中的位置。</p>
<p>app.activeDocument.artLayers[0].move(app.activeDocument.artLayers[2], ElementPlacement.PLACEBEFORE)<br>photoFilter( 填充颜色, 浓度, 保留明度 )<br>照片滤镜。</p>
<p>查看图片</p>
<p>var c &#x3D; new SolidColor()<br>c.rgb.hexValue&#x3D;”ff0000”<br>app.activeDocument.artLayers[0].photoFilter(c,25,true )<br>posterize( 色阶 )<br>色调分离 。（1~100）</p>
<p>查看图片</p>
<p>rasterize( 目标 )<br>栅格化图层，目标可以为：</p>
<p>RasterizeType.ENTIRELAYER 栅格化图层<br>RasterizeType.FILLCONTENT 栅格化填充内容（生成矢量蒙版）<br>RasterizeType.LAYERCLIPPINGPATH 栅格化矢量蒙版<br>RasterizeType.TEXTCONTENTS  栅格化文字<br>RasterizeType.LINKEDLAYERS  栅格化链接的图层<br>RasterizeType.SHAPE 栅格化形状<br>remove()<br>删除图层。</p>
<p>resize( 水平位置, 垂直位置, 描点位置 )<br>重设图层尺寸，锚点位置即为不动点的位置查看图片，在手动使用 PS 的自由变换工具时，鼠标操作点的对点，就是缩放的锚点。锚点参数可空，缺省值是正中。锚点位置。</p>
<p>查看图片</p>
<p>rotate( 角度 , 描点位置 )<br>旋转。顺时针旋转。</p>
<p>查看图片</p>
<p>selectiveColor( 方法, [红色], [黄色], [绿色], [青色], [蓝色], [洋红], [白色], [中性色], [黑色] )<br>可选颜色，方法参数可为：</p>
<p>AdjustmentReference.ABSOLUTE  绝对<br>AdjustmentReference.RELATIVE  相对<br>每个颜色的参数为 [C, M, Y, K] 颜色数组(-100~100)</p>
<p>查看图片</p>
<p>shadowHighlight( 阴影数量, 色调, 阴影半径, 高光数量, 高光色调, 高光半径, 调整颜色, 调整中间调, 调整修剪黑色, 调整修正白色 )<br>阴影&#x2F;高高。</p>
<p>查看图片</p>
<p>threshold( 阈值色阶 )<br>阈值。（1~255）</p>
<p>查看图片</p>
<p>translate( X 偏移值 , Y 偏移值)<br>移动，移动图层位置。</p>
<p>其偏移值是 UnitValue 类型。</p>
<p>var X &#x3D;UnitValue(“22 mm”)<br>var Y &#x3D;UnitValue(“44 mm”)<br>app.activeDocument.artLayers[0].translate(X , Y);<br>或者直接使用整数，其单位将是首选项的标尺单位设置：</p>
<p>app.activeDocument.activeLayer.translate(22, 256);<br>查看图片</p>
<p>unlink()<br>取消图层链接。</p>
<p>LayerSet<br>图层组。图层组很多属性和方法都和图层一样，所以可以参考图层中的用法。图层组的关键是它和 docment 一样有 artLayers、layerSets 和 layers 三个合集，用它们遍历图层组中的嵌套的图层和图层组。</p>
<p>属性<br>allLocked boolean<br>图层组锁定全部。true 为锁定。完全不能选中和编辑图层。</p>
<p>blendMode BlendMode<br>混合模式。</p>
<p>artLayers ArtLayers<br>图层组中的图层。不包括图层组和图层组中的图层。</p>
<p>layers Layers<br>图层和图层组的合集。</p>
<p>layerSets LayerSets<br>图层组的合集。</p>
<p>itemIndex number<br>内部索引号。图层组在 PhotoShop 内部的的索引号，无关图层组嵌套。序号从下至上递增，背景图层为 1。图层组与图层相同，都有一个索引号。</p>
<p>linkedLayers ArtLayer 或 LayerSet 数组<br>图层链接，只读。</p>
<p>查看图片</p>
<p>name string<br>名称。</p>
<p>opacity number<br>不透明度（0-100）。</p>
<p>visible boolean<br>是否可视。</p>
<p>enabledChannels Channel 数组<br>启用通道。</p>
<p>方法<br>LayerSet duplicate( 相对图层\组, 相对位置 )<br>创建一个图层组副本。可不传入参数，将副本放在原件之后。此外还可以用参数控制创建的副本在图层面板中的位置，新的副本创建在相对图层\组的相对位置。</p>
<p> ElementPlacement<br>ElementPlacement.INSIDE 插入图层组<br>ElementPlacement.PLACEATBEGINNING 图层组首位<br>ElementPlacement.PLACEATEND 图层组末位<br>ElementPlacement.PLACEBEFORE  之前<br>ElementPlacement.PLACEAFTER 之后<br>link( 连接目标 )<br>与连接目标创建图层连接，连接目标可以是图层或图层组。</p>
<p>unlink()<br>取消图层链接。</p>
<p>merge()<br>向下合并图层，返回值为合并后的图层。</p>
<p>move( 相对图层\组, 相对位置 )<br>移动图层组在图层面板中的位置。</p>
<p>remove()<br>删除图层组。</p>
<p>resize( 水平位置, 垂直位置, 描点位置 )<br>重设图层尺寸。锚点位置即为不动点的位置查看图片，在手动使用 PS 的自由变换工具时，鼠标操作点的对点，就是缩放的锚点。锚点参数可空，缺省值是正中。锚点位置。</p>
<p>rotate( 角度 , 描点位置 )<br>旋转。顺时针旋转。</p>
<p>translate( X 偏移值 , Y 偏移值)<br>移动，移动图层位置。</p>
<p>文本与字体<br>TextItem<br>属性<br>contents string<br>文本内容。</p>
<p>color SolidColor<br>文本颜色。</p>
<p>position　 UnitValue 数组<br>文本框位置，以 UnitValue 数组形式表示：[X, Y]</p>
<p>查看图片</p>
<p>size UnitValue<br>字体大小</p>
<p>alternateLigatures boolean<br>自由连字。</p>
<p>查看图片</p>
<p>antiAliasMethod AntiAlias<br>消除锯齿方式。</p>
<p>AntiAlias.CRISP 犀利<br>AntiAlias.NONE  无<br>AntiAlias.SHARP 锐利<br>AntiAlias.SMOOTH  模糊<br>AntiAlias.STRONG  浑厚<br>Winodws 或 Winodws LCD 方式需要使用 ActionDescriptor ：</p>
<p>var idsetd &#x3D; charIDToTypeID( “setd” );<br>    var desc &#x3D; new ActionDescriptor();<br>    var idnull &#x3D; charIDToTypeID( “null” );<br>        var ref &#x3D; new ActionReference();<br>        var idPrpr &#x3D; charIDToTypeID( “Prpr” );<br>        var idAntA &#x3D; charIDToTypeID( “AntA” );<br>        ref.putProperty( idPrpr, idAntA );<br>        var idTxLr &#x3D; charIDToTypeID( “TxLr” );<br>        var idOrdn &#x3D; charIDToTypeID( “Ordn” );<br>        var idTrgt &#x3D; charIDToTypeID( “Trgt” );<br>        ref.putEnumerated( idTxLr, idOrdn, idTrgt );<br>    desc.putReference( idnull, ref);<br>    var idT &#x3D; charIDToTypeID( “T   “ );<br>    var idAnnt &#x3D; charIDToTypeID( “Annt” );<br>    &#x2F;&#x2F;antiAliasPlatformGray 是“Windows”，antiAliasPlatformLCD 是“Windows LCD”<br>    var idantiAliasPlatformLCD &#x3D; stringIDToTypeID( “antiAliasPlatformLCD” );<br>    desc.putEnumerated( idT, idAnnt, idantiAliasPlatformLCD );<br>executeAction( idsetd, desc, DialogModes.NO );<br>autoKerning AutoKernType<br>字距调整，调整两个字符间距微调。</p>
<p>AutoKernType.MANUAL 手动指定<br>AutoKernType.METRICS  度量标准<br>AutoKernType.OPTICAL  视觉<br>查看图片</p>
<p>useAutoLeading boolean<br>使用自动行距。</p>
<p>app.activeDocument.artLayers[0].textItem.useAutoLeading&#x3D;false<br>查看图片</p>
<p>autoLeadingAmount number<br>自动行距数量。 [0.01 ~ 5000.00]</p>
<p>baselineShift UnitValue<br>基线偏移。</p>
<p>查看图片</p>
<p>capitalization TextCase<br>大写化。</p>
<p>TextCase.NORMAL 正常<br>TextCase.ALLCAPS  全部大写<br>TextCase.SMALLCAPS  小型大写字母<br>查看图片</p>
<p>desiredGlyphScaling number<br>字符缩放期望（50~200），用于 2 侧对齐时。</p>
<p>desiredLetterScaling number<br>字距缩放期望（100~500），用于 2 侧对齐时。</p>
<p>direction Direction<br>文本取向。</p>
<p>Direction.HORIZONTAL  水平<br>Direction.VERTICAL  垂直<br>fauxBold boolean<br>仿粗体。</p>
<p>fauxItalic boolean<br>仿斜体。</p>
<p>firstLineIndent UnitValue (pt)<br>首行缩进，单位是 pt 。</p>
<p>查看图片</p>
<p>font string<br>字体。指定字体的 postScriptName 名称。</p>
<p>hangingPunctuation boolean<br>标点悬挂，标点符号位置能否超出文本框范围<br>标点悬挂为真：</p>
<p>查看图片</p>
<p>标点悬挂为假：</p>
<p>查看图片</p>
<p>height UnitValue<br>文本框高度。</p>
<p>width UnitValue<br>文本框宽度</p>
<p>horizontalScale number<br>水平缩放 （0~1000）。</p>
<p>查看图片</p>
<p>hyphenation boolean<br>换行时使用连字符。</p>
<p>hyphenateCapitalWords boolean<br>允许换行时对大写单词使用连字符。</p>
<p>hyphenateAfterFirst number<br>换行符后可以有多少字（1~15）。</p>
<p>hyphenateBeforeLast number<br>换行符前可以有多少字（1~15）。</p>
<p>hyphenationZone UnitValue<br>行末到令文本不能对齐的字的距离 （0~720 pc 派卡 ）。</p>
<p>hyphenLimit number<br>连接符可连接最大字数。</p>
<p>justification Justification<br>段落对齐方式：</p>
<p>Justification.LEFT  左对齐<br>Justification.CENTER  居中<br>Justification.RIGHT 右对齐<br>Justification.LEFTJUSTIFIED 两侧对齐，最后一行左对齐<br>Justification.CENTERJUSTIFIED 两侧对齐，最后一行居中<br>Justification.RIGHTJUSTIFIED  两侧对齐，最后一行右对齐<br>Justification.FULLYJUSTIFIED  两侧对齐，全部对齐<br>查看图片<br>kind TextType<br>文本类型</p>
<p>TextType.PARAGRAPHTEXT  段落文字，文本框<br>查看图片<br>TextType.POINTTEXT  点文本，没有文本框<br>查看图片<br>language Language<br>文本语言，很多不支持。</p>
<p>Language.BRAZILLIANPORTUGUESE 巴西葡萄牙语<br>Language.CANADIANFRENCH 加拿大法语<br>Language.DANISH 丹麦语<br>Language.DUTCH  荷兰语<br>Language.ENGLISHUK  英式英语<br>Language.ENGLISHUSA 美式英语<br>Language.FINNISH  芬兰语<br>Language.FRENCH 法语<br>Language.GERMAN 德语<br>Language.ITALIAN  意大利语<br>Language.NORWEGIAN  挪威语<br>Language.NYNORSKNORWEGIAN 新挪威语<br>Language.OLDGERMAN  古德语<br>Language.PORTUGUESE 葡萄牙语<br>Language.SPANISH  西班牙语<br>Language.SWEDISH  瑞典语<br>Language.SWISSGERMAN  瑞士德语<br>leading UnitValue<br>行距。</p>
<p>查看图片</p>
<p>leftIndent UnitValue<br>左缩进（-1296~1296 pt）。无法设置</p>
<p>查看图片</p>
<p>rightIndent UnitValue<br>右缩进（-1296~1296 pt）。无法设置</p>
<p>ligatures boolean<br>使用连字</p>
<p>spaceAfter UnitValue<br>断后添加空格（-1296~1296 pt）。无法设置</p>
<p>查看图片</p>
<p>spaceBefore UnitValue<br>断前添加空格（-1296~1296 pt）。无法设置</p>
<p>maximumGlyphScaling number<br>最大字符缩放（50~200）。在两端对齐时，字符的最大可缩放大小，为 100 时不缩放。</p>
<p>minimumGlyphScaling number<br>最小字符缩放（50~200）。</p>
<p>查看图片</p>
<p>maximumLetterScaling number<br>最大单词中缩放（0~500）。在两端对齐时，单词中最大的可拉伸距离，如果为 0 ，则不拉伸单词中的距离，而是全部由单词间的空格填补距离。</p>
<p>minimumLetterScaling number<br>最小单词中缩放（0~500）。</p>
<p>查看图片</p>
<p>maximumWordScaling number<br>最大单词间缩放（0~1000）。在两端对齐时，单词间最大的可拉伸距离。</p>
<p>minimumWordScaling number<br>最小单词间缩放（0~1000）。</p>
<p>noBreak boolean<br>不自动换行</p>
<p>oldStyle boolean<br>使用老样式</p>
<p>underline UnderlineType<br>下划线，在垂直方向的文本框中可以控制下划线左右方向。水平方向的文本框两种常量没有区别。</p>
<p>UnderlineType.UNDERLINELEFT 左下划线<br>UnderlineType.UNDERLINERIGHT  右下划线<br>UnderlineType.UNDERLINEOFF  无下划线<br>左下划线与右下划线：</p>
<p>查看图片查看图片</p>
<p>strikeThru StrikeThruType<br>删除线。</p>
<p>StrikeThruType.STRIKEBOX  偏上<br>查看图片<br>StrikeThruType.STRIKEHEIGHT 中间<br>查看图片<br>StrikeThruType.STRIKEOFF  无删除线<br>textComposer TextComposer<br>文本处理器，影响换行断字和对齐方法</p>
<p>TextComposer.ADOBEEVERYLINE  Adobe 每行<br>TextComposer.ADOBESINGLELINE  Adobe 单一行<br>tracking number<br>字距调整值（-1000~10000）。</p>
<p>查看图片</p>
<p>useAutoLeading boolean<br>自动行距，使用字体自带的行距信息</p>
<p>verticalScale number<br>垂直缩放（0~1000）</p>
<p>查看图片</p>
<p>warpStyle WarpStyle<br>变形文字，样式。</p>
<p>查看图片<br>WarpStyle.NONE  无<br>WarpStyle.ARC 扇形<br>WarpStyle.ARCLOWER  下弧<br>WarpStyle.ARCUPPER  上弧<br>WarpStyle.ARCH  拱形<br>WarpStyle.BULGE 凸起<br>WarpStyle.SHELLLOWER  贝壳<br>WarpStyle.SHELLUPPER  花冠<br>WarpStyle.FLAG  旗帜<br>WarpStyle.WAVE  波浪<br>WarpStyle.FISH  鱼形<br>WarpStyle.RISE  增加<br>WarpStyle.FISHEYE 鱼眼<br>WarpStyle.INFLATE 膨胀<br>WarpStyle.SQUEEZE 挤压<br>WarpStyle.TWIST 扭转<br>warpBend number<br>弯曲（-100~100），变形文字的弯曲选参数。</p>
<p>查看图片</p>
<p>warpDirection Direction<br>变形文字方向</p>
<p>Direction.HORIZONTAL  水平<br>Direction.VERTICAL  垂直<br>warpHorizontalDistortion number<br>变形文字， 水平扭曲（-100~100）.</p>
<p>warpVerticalDistortion number<br>变形文字， 垂直扭曲（-100~100）.</p>
<p>方法<br>convertToShape()<br>转换为形状。</p>
<p>createPath()<br>创建工作路径。</p>
<p>宿主与文档<br>Application<br>属性<br>activeDocument Document<br>当前文档。</p>
<p>backgroundColor SolidColor<br>背景颜色。</p>
<p>查看图片</p>
<p>foregroundColor SolidColor<br>前景颜色。</p>
<p>build string<br>宿主程序信息。<br>如：16.1.2 (2015.1.2 20160113.r.355 2016&#x2F;01&#x2F;13:23:59:59 CL 1059143)</p>
<p>colorSettings string<br>颜色设置。即为 PS 的菜单：“编辑-颜色设置-设置”。</p>
<p>查看图片</p>
<p>currentTool string<br>当前工具，如“artboardTool”（画板工具）。</p>
<p>工具名称列表</p>
<p>moveTool  移动工具<br>artboardTool  画板工具<br>marqueeRectTool 矩形选框工具<br>lassoTool 套索工具<br>quickSelectTool 快速选择工具<br>cropTool  剪裁工具<br>sliceTool 切片工具<br>sliceSelectTool 切片选择工具<br>eyedropperTool  吸管工具<br>colorSamplerTool  颜色取样器工具<br>rulerTool 标尺工具<br>paintbrushTool  画笔工具<br>pencilTool  铅笔工具<br>eraserTool  橡皮擦工具<br>bucketTool  油漆桶工具<br>gradientTool  渐变工具<br>typeCreateOrEditTool  横排文字工具<br>typeVerticalCreateOrEditTool  直排文字工具<br>typeVerticalCreateOrEditTool  钢笔工具<br>typeVerticalCreateOrEditTool  自由钢笔工具<br>addKnotTool 添加锚点工具<br>deleteKnotTool  删除锚点工具<br>convertKnotTool 转换点工具<br>directSelectTool  直接选择工具<br>pathComponentSelectTool 路径选择工具<br>rectangleTool 矩形工具<br>polygonTool 多边形工具<br>roundedRectangleTool  圆角矩形工具<br>ellipseTool 椭圆工具<br>customShapeTool 自定形状工具<br>handTool  抓手工具<br>handTool  缩放工具<br>marqueeEllipTool  椭圆选框工具<br>marqueeSingleRowTool  单行选框工具<br>marqueeSingleColumnTool 单列选框工具<br>polySelTool 多边形套索工具<br>magneticLassoTool 磁性套索工具<br>perspectiveCropTool 透视裁剪工具<br>spotHealingBrushTool  污点修复画笔工具<br>magicStampTool  修复画笔工具<br>patchSelection  修补工具<br>recomposeSelection  内容感知移动工具<br>redEyeTool  红眼工具<br>cloneStampTool  仿制图章工具<br>patternStampTool  图案图章工具<br>backgroundEraserTool  背景橡皮擦工具<br>magicEraserTool 魔术橡皮擦工具<br>dodgeTool 减淡工具<br>burnInTool  加深工具<br>saturationTool  海绵工具<br>blurTool  模糊工具<br>sharpenTool 锐化工具<br>smudgeTool  涂抹工具<br>3DMaterialSelectTool  3D 材质吸管工具<br>textAnnotTool 注释工具<br>countTool 计数工具<br>colorReplacementBrushTool 颜色替换工具<br>wetBrushTool  混合器画笔工具<br>historyBrushTool  历史记录画笔工具<br>artBrushTool  历史记录艺术画笔工具<br>3DMaterialDropTool  3D 材质拖放工具<br>typeVerticalCreateMaskTool  直排文字蒙版工具<br>typeCreateMaskTool  横排文字蒙版工具<br>lineTool  直线工具<br>rotateTool  旋转视图工具<br>查看图片</p>
<p>displayDialogs DialogModes<br>运行脚本时宿主程序和时弹出对话框。</p>
<p>DialogModes.ALL 弹出所有<br>DialogModes.ERROR 只有弹出错误对话框<br>DialogModes.NO  不弹出对话框<br>documents Documents<br>所有打开文档的合集。只读。</p>
<p>fonts TextFonts<br>系统中的字体列表。</p>
<p>freeMemory number<br>空闲内存。PS 能够使用的剩余内存量。</p>
<p>locale string<br>宿主的地域语言。<br>格式为 xx_YY，xx 为 2 个字节的 ISO-639 语言代码，YY 为 2 个字节的 ISO 3166 国家代码。<br>如：zh_CN、 en_US、en_UK、ja_JP</p>
<p>measurementLog MeasurementLog<br>测量记录。可以导出或删除测量工具的测量记录。</p>
<p>name string<br>宿主名称。<br>如：Adobe Photoshop</p>
<p>notifiersEnabled boolean<br>是否启用脚本事件。</p>
<p>notifiers Notifiers<br>脚本事件合集。可以添加或移除脚本事件。</p>
<p>查看图片</p>
<p>path File<br>宿主应用所在目录。<br>如： &#x2F;d&#x2F;Creative&#x2F;Adobe&#x2F;Adobe%20Photoshop%20CC%202015<br>（%20 代表空格）</p>
<p>playbackDisplayDialogs DialogModes<br>重放对话框设置。</p>
<p>DialogModes.ALL 弹出所有<br>DialogModes.ERROR 只有弹出错误对话框<br>DialogModes.NO  不弹出对话框<br>playbackParameters ActionDescriptor<br>重复参数。</p>
<p>preferences Preferences<br>首选项。获得首选项参数。只读。</p>
<p>recentFiles File 数组<br>最近文件列表。只读。</p>
<p>scriptingBuildDate string<br>脚本接口生成时间。<br>如：Jan 13 2016 00:19:41</p>
<p>scriptingVersion string<br>脚本接口版本。<br>如：16.1.2</p>
<p>systemInformation string<br>系统信息。与“菜单-帮助-系统信息”中获取的内容相同。</p>
<p>查看图片</p>
<p>version string<br>宿主版本号。</p>
<p>macintoshFileTypes string 数组<br>宿主可以打开的文件格式数组（Mac）。</p>
<p>windowsFileTypes string 数组<br>宿主可以打开的文件格式数组（Windows）。</p>
<p>方法<br>load( 文档 )<br>载入文档。<br>app.load( new File(“&#x2F;E&#x2F;图片库&#x2F;2014_8_29[22.48.52].png”) )</p>
<p>open(文档, 打开选项, 是否作为智能对象 )<br>打开文件。</p>
<p>打开一个文档。打开选项是可选的，可用使用 OpenDocumentType 指定文件格式，也能使用下面这些对象作为打开特定格式时的选项，例如导入 PDF 时的选项：<br>CameraRAWOpenOptions、DICOMOpenOptions、EPSOpenOptions、PDFOpenOptions、PhotoCDOpenOptions、RawFormatOpenOptions</p>
<p>是否作为智能对象为真时会把文档作为智能对象添加到已打开的文档中。</p>
<p>文档：File<br>打开选项：object 或 OpenDocumentType<br>是否作为智能对象：boolean</p>
<p>File 数组 openDialog()<br>打开文件对话框。弹出打开文件对话框让用户选择文件（选中的文件不会被宿主打开），返回打开文件的 File 数组。</p>
<p>beep()<br>发出提示音。</p>
<p>boolean showColorPicker()<br>打开拾色器，如果用户没有选择颜色返回假。</p>
<p>bringToFront()<br>激活宿主应用的窗口。</p>
<p>doAction(动作名, 动作组名)<br>执行一个动作。<br>app.doAction(“动作 1”, “组 1”)</p>
<p>查看图片</p>
<p>doProgress( 进度条文本, 执行代码 )<br>执行进度条任务。<br>进度条文本：string<br>执行代码：string</p>
<p>app.doProgress(“已经完成 0&#x2F;10 了哟！”,”task()”)<br>function task(){<br>for( var i&#x3D;1;i&lt;10; i++)<br>{<br>updateProgress(i, 10);<br>changeProgressText(“已经完成 “ + i + “ &#x2F; 10 了哟！”)<br>app.refresh();&#x2F;&#x2F;刷新界面，这会让脚步运行速度大大降低，尽量减少频率<br>}<br>}<br> 查看图片</p>
<p>updateProgress( 已完成, 总数 )<br>更新进度条。</p>
<p>已完成：number<br>总数：number</p>
<p>changeProgressText( 进度条文本 )<br>改变进度条文本。</p>
<p>进度条文本：string</p>
<p>doForcedProgress( 进度条文本, 执行代码 )<br>执行无法取消的进度条任务。</p>
<p>进度条文本：string<br>执行代码：string</p>
<p>doProgressSegmentTask( 段长度, 已完成长度, 总长度, 执行代码 )<br>执行进度条任务段。</p>
<p>段长度：number<br>已完成长度：number<br>总长度：number<br>执行代码：string</p>
<p>doProgressSubTask( 任务索引, 任务总数, 执行代码 )<br>执行进度条子任务。</p>
<p>任务索引：number<br>任务总数：number<br>执行代码：string</p>
<p>doProgressTask( 任务长度, 执行代码 )<br>执行进度条任务。</p>
<p>任务长度：number<br>执行代码：string</p>
<p>ActionDescriptor getCustomOptions( 键 )<br>取自定义选项。</p>
<p>putCustomOptions( 键, 自定义选项, 持久化 )<br>添加自定义选项。键是这个自定义选项的唯一可识别标志。持久化如果为真，这个自定义选项在此脚本结束后仍有效。</p>
<p>键：string</p>
<p>自定义选项：ActionDescriptor<br>持久化：boolean</p>
<p>eraseCustomOptions( 键 )<br>清除自定义选项。<br>从宿主中清除指定 ID 的用户对象。</p>
<p>键：string</p>
<p>executeAction( 事件, 动作描述符, 对话框模式 )<br>执行动作代理事件。</p>
<p>事件：number<br>动作描述符：ActionDescriptor<br>对话框模式：DialogModes</p>
<p>ActionDescriptor executeActionGet( 动作参考 )<br>取执行动作描述符。<br>从一个 ActionReference 中得到 ActionDescriptor 信息。</p>
<p>boolean featureEnabled( 名称 )<br>查询特性可用。<br>查询属于各版本的功能是否可用。<br>“photoshop&#x2F;extended”：扩展版<br>“photoshop&#x2F;standard”：标准版<br>“photoshop&#x2F;trial”：体验版</p>
<p>&#x2F;&#x2F;查询扩展版功能是否可用<br>app.featureEnabled(“photoshop&#x2F;extended”)<br>boolean isQuicktimeAvailable()<br>系统中是否安装了 Quicktime。</p>
<p>purge( 目标 )<br>清除缓存。</p>
<p>PurgeTarget.ALLCACHES 全部缓存<br>PurgeTarget.CLIPBOARDCACHE  剪切板缓存<br>PurgeTarget.HISTORYCACHES 历史记录<br>PurgeTarget.UNDOCACHES  重做缓存<br>refresh()<br>刷新宿主。暂停脚本而刷新宿主，常用于在执行长时间脚本时让用户看的当前结果。</p>
<p>refreshFonts()<br>刷新字体列表。</p>
<p>runMenuItem( 菜单 ID )<br>打开一个指定菜单。</p>
<p>菜单 ID：number</p>
<p>number charIDToTypeID( charID )<br>将字符 ID 转换为实际运行 ID。</p>
<p>charID：string</p>
<p>number stringIDToTypeID( stringID )<br>把字符串 ID 转换为实际运行 ID。</p>
<p>stringID：string</p>
<p>string typeIDToCharID( typeID )<br>实际运行 ID 转化为字符 ID。</p>
<p>typeID：number</p>
<p>string typeIDToStringID( typeID )<br>实际运行 ID 转化为字符串 ID。</p>
<p>typeID：number</p>
<p>togglePalettes()<br>切换宿主窗口显示模式。</p>
<p>boolean toolSupportsBrushes(工具)<br>检查工具可用。</p>
<p>工具：string</p>
<p>batch( 输入文件, 动作, 目标, 选项 )<br>批处理。“菜单-文件-自动-批处理”。</p>
<p>输入文件：File 数组<br>动作：string<br>目标：string<br>选项：BatchOptions</p>
<p>查看图片</p>
<p>Document<br>属性<br>channels Channels<br>通道合集。</p>
<p>activeHistoryBrushSourceGuide HistoryState<br>当前编辑的历史历史记录（即有“笔图标”的历史记录）。</p>
<p>查看图片</p>
<p>activeHistoryState HistoryState<br>当前选中的历史记录</p>
<p>activeLayer ArtLayer 或 LayerSet<br>选中的图层或图层组。</p>
<p>artLayers ArtLayers<br>文档根目录的图层合集。不包括图层组。</p>
<p>backgroundLayer ArtLayer<br>背景图层。</p>
<p>bitsPerChannel BitsPerChannelType<br>颜色位数。</p>
<p>BitsPerChannelType.EIGHT  8 位（默认）<br>BitsPerChannelType.ONE  1 位<br>BitsPerChannelType.SIXTEEN  16 位<br>BitsPerChannelType.THIRTYTWO  32 位<br>colorProfileType ColorProfile<br>色彩管理方式。</p>
<p>ColorProfile.NONE 不对此文档应用色彩管理<br>ColorProfile.WORKING  工作中的色彩配置文件<br>ColorProfile.CUSTOM 自定义配置文件<br>colorProfileName string<br>色彩配置文件名。需要色彩管理方式为 ColorProfile.CUSTOM 。</p>
<p>app.activeDocument.colorProfileName &#x3D; “Adobe RGB (1998)”<br>app.activeDocument.colorProfileType &#x3D; ColorProfile.CUSTOM<br> 查看图片</p>
<p>mode DocumentMode<br>文档色彩模型。</p>
<p>DocumentMode.BITMAP 位图<br>DocumentMode.CMYK CMYK<br>DocumentMode.DUOTONE  双色调<br>DocumentMode.INDEXEDCOLOR 索引颜色<br>DocumentMode.GRAYSCALE  灰度<br>DocumentMode.MULTICHANNEL 多通道<br>DocumentMode.RGB  RGB<br>DocumentMode.LAB  Lab<br>colorSamplers ColorSamplers<br>色彩取样点合集。</p>
<p>方法  作用<br>ColorSamplers.add(x, y) 添加采样点<br>ColorSamplers.removeAll() 移除全部采样点<br>componentChannels Channel 数组<br>构成通道合集，如 RGB 色彩模式的红、绿、蓝通道。</p>
<p>fullName File<br>文件完整路径。</p>
<p>app.activeDocument.fullName &#x2F;&#x2F;“&#x2F;e&#x2F;Work&#x2F;m.psd”<br>guides Guides<br>参考线合集。</p>
<p>height UnitValue<br>文档高度。只读。</p>
<p>width UnitValue<br>文档宽度。只读。</p>
<p>histogram number 数组<br>直方图。256 个数的数组表示的直方图。</p>
<p>historyStates HistoryStates<br>历史记录合集。</p>
<p>info DocumentInfo<br>文档元数据信息。</p>
<p>layerComps LayerComps<br>图层复合。</p>
<p>layers layers<br>图层和图层组的合集。</p>
<p>layerSets LayerSets<br>图层组的合集。</p>
<p>managed boolean<br>是否是工作组文档，只读。</p>
<p>name string<br>文档名称。只读。</p>
<p>path File<br>文档所在目录路径。<br>如：&#x2F;e&#x2F;Work&#x2F;GitHub&#x2F;PS.fonTags&#x2F;logo</p>
<p>pathItems PathItems<br>路径元素合集。只读。</p>
<p>pixelAspectRatio number<br>像素长宽比。</p>
<p>查看图片</p>
<p>printSettings DocumentPrintSettin<br>文档打印设置。只读。</p>
<p>quickMaskMode boolean<br>快速蒙版模式。</p>
<p>查看图片</p>
<p>resolution number<br>文档分辨率（像素&#x2F;英寸）。</p>
<p>saved boolean<br>最后一次编辑后文档是否已保存。</p>
<p>selection Selection<br>文档选中区域。</p>
<p>xmpMetadata xmpMetadata<br>XMP 元数据。用 xmpMetadata.rawData 获取和修改 XMP 原数据的 XML 。</p>
<p>countItems countItems<br>计数工具，计数点合集。</p>
<p>方法<br>changeMode( 目标模型, 选项 )<br>改变文档色彩模型。</p>
<p>目标模型：ChangeMode</p>
<p>ChangeMode.BITMAP 位图<br>ChangeMode.CMYK CMYK<br>ChangeMode.GRAYSCALE  灰度<br>ChangeMode.INDEXEDCOLOR 索引颜色<br>ChangeMode.LAB  Lab<br>ChangeMode.MULTICHANNEL 多通道<br>ChangeMode.RGB  RGB<br>选项： BitmapConversionOptions（位图）或 IndexedConversionOptions（索引颜色）</p>
<p>close( 是否存储 )<br>关闭文档。</p>
<p>是否存储：SaveOptions</p>
<p>SaveOptions.DONOTSAVECHANGES  不存储改变<br>SaveOptions.PROMPTTOSAVECHANGES 用户选择（弹出对话框）<br>SaveOptions.SAVECHANGES 存储改变<br>convertProfile( 目标空间配置文件, 意图, 黑场补偿, 使用仿色 )<br>转化为配置文件。</p>
<p>目标空间配置文件：string<br>意图：intent</p>
<p>Intent.PERCEPTUAL 可感知<br>Intent.SATURATION 饱和度<br>Intent.RELATIVECOLORIMETRIC 相对比色<br>Intent.ABSOLUTECOLORIMETRIC 绝对比色<br>黑场补偿：boolean<br>使用仿色：boolean</p>
<p>查看图片</p>
<p>crop( 区域, 角度, 新宽度, 新高度 )<br>剪裁。按区域进行剪裁。角度和新宽度、新高度是可选选项，是将剪裁后的内容选择并拉伸到新尺寸，可省略。在文档有画板的情况下不能剪裁。</p>
<p>区域： UnitValue 数组<br>角度：number<br>新宽度： UnitValue<br>新高度： UnitValue</p>
<p>app.activeDocument.crop([UnitValue (“0px”), UnitValue (“0px”), UnitValue (“150px”), UnitValue (“250px”)]);<br>duplicate( 新名称, 拼合图层 )<br>复制文档。创建一个文档的副本，你可以指定副本的名称，和是否拼合新文档的所有图层。</p>
<p>新名称：name<br>拼合图层：boolean</p>
<p>查看图片</p>
<p>exportDocument( 文档路径, 导出类型, 选项 )<br>导出文档，即是菜单-文件-导出中的 “路径到illustrator…” ，“存储为 Web 所用格式”。</p>
<p>文档路径：ExportType</p>
<p>ExportType.ILLUSTRATORPATHS 导出为 illustrator路径<br>ExportType.SAVEFORWEB 存储为 Web 所用格式<br>选项：ExportOptionsIllustrator 或 ExportOptionsSaveForWeb</p>
<p>ExportOptionsIllustrator<br>path IllustratorPathType<br>IllustratorPathType.ALLPATHS</p>
<p>所有路径<br>IllustratorPathType.DOCUMENTBOUNDS</p>
<p>文档范围<br>IllustratorPathType.NAMEDPATH</p>
<p>指定名称路径</p>
<p>pathName string 路径名称，当路径类型为 IllustratorPathType.NAMEDPATH 的时候有效，指定要导出的路径名称。<br>ExportOptionsSaveForWeb</p>
<p>flatten()<br>拼合图像。</p>
<p>resizeCanvas ( 宽度, 高度, 锚点 )<br>重设画布大小。</p>
<p>宽度： UnitValue<br>宽度： UnitValue<br>锚点：AnchorPosition</p>
<p>AnchorPosition<br>AnchorPosition.TOPLEFT<br>左上  AnchorPosition.TOPCENTER<br>正上  AnchorPosition.TOPRIGHT<br>右上<br>AnchorPosition.MIDDLELEFT<br>左中  AnchorPosition.MIDDLECENTER<br>正中  AnchorPosition.MIDDLERIGHT<br>右中<br>AnchorPosition.BOTTOMLEFT<br>左下  AnchorPosition.BOTTOMCENTER<br>正下  AnchorPosition.BOTTOMRIGHT<br>右下<br>resizeImage( 宽度, 高度, 分辨率, 重新采样, 减少杂色 )<br>重设图像大小。<br>宽度： UnitValue<br>高度： UnitValue<br>分辨率：number<br>重新采样：ResampleMethod</p>
<p>ResampleMethod<br>ResampleMethod.AUTOMATIC  自动<br>ResampleMethod.BICUBIC  两次立方<br>ResampleMethod.BICUBICAUTOMATIC 两次立方自动<br>ResampleMethod.BICUBICSHARPER 两次立方（较锐利）（缩减）<br>ResampleMethod.BICUBICSMOOTHER  两次立方（较平滑）（扩大）<br>ResampleMethod.BILINEAR 两次线性<br>ResampleMethod.NEARESTNEIGHBOR  邻近（硬边缘）<br>ResampleMethod.NONE 无<br>ResampleMethod.PRESERVEDETAILS  保留细节（扩大）<br>查看图片</p>
<p>revealAll()<br>显示全部。“菜单-图像-显示全部”<br>自动调整画布尺寸以显示所有内容。</p>
<p>save()<br>保存。</p>
<p>saveAs( 文件, 选项, 作为副本, 扩展名大小写 )<br>另存为。</p>
<p>文件：File<br>选项：BMPSaveOptions、GIFSaveOptions、JPEGSaveOptions、PNGSaveOptions<br>作为副本：boolean<br>扩展名大小写：Extension</p>
<p>Extension<br>Extension.LOWERCASE 小写<br>Extension.UPPERCASE 大写<br>Extension.NONE  不处理<br>splitChannels()<br>分离通道，把通道分离为单个文档。返回新建的 Document 数组。</p>
<p>suspendHistory( 历史记录名称, 代码)<br>创建历史记录。<br>执行一段代码，并为其创建一个历史记录：</p>
<p>app.activeDocument.suspendHistory(“新建 3 个图层哟”, “addLayer(3)”);<br>function addLayer(n){<br>    for(var i&#x3D;0; i<br> 查看图片</p>
<p>rotateCanvas( 角度 )<br>旋转画布。</p>
<p>角度：number</p>
<p>flipCanvas(方向)<br>翻转画布 。</p>
<p>方向：Direction</p>
<p>Direction<br>Direction.HORIZONTAL  水平<br>Direction.VERTICAL  垂直<br>importAnnotations( 注释文件 )<br>导入注释。“菜单-文件-导入注释”。</p>
<p>mergeVisibleLayers()<br>合并可见图层。</p>
<p>rasterizeAllLayers()<br>栅格化所有图层。</p>
<p>paste( 粘贴到选择区域 )<br>粘贴。如果粘贴到选择区域为真，则会粘贴到选择区域。</p>
<p>粘贴到选择区域：boolean</p>
<p>trim( 裁切类型, 顶, 左, 底, 右 )<br>裁切。</p>
<p>裁切类型：TrimType</p>
<p>TrimType.BOTTOMRIGHT  右下角像素颜色<br>TrimType.TOPLEFT  左上角像素颜色<br>TrimType.TRANSPARENT  透明像素<br>顶：boolean<br>左：boolean<br>底：boolean<br>右：boolean</p>
<p>查看图片</p>
<p>print( 源空间, 打印空间, 意图, 黑点补偿 )<br>打印文档。</p>
<p>源空间：SourceSpaceType<br>打印空间：string<br>意图：Intent<br>黑点补偿：boolean</p>
<p>trap( 宽度 )<br>烙印。菜单-图像-烙印。当图像为 CMYK 模式时有效。</p>
<p>查看图片</p>
<p>measurementScale MeasurementScale<br>“菜单-图像-分析-设置测量比例”的设置。只有 Extended 版的 PS 才有此功能。</p>
<p>查看图片</p>
<p>MeasurementScale<br>pixelLength number  像素长度<br>logicalLength number  逻辑长度<br>logicalUnits string 逻辑单位<br>recordMeasurements ( 来源, 数据点 )</p>
<p>记录测量。</p>
<p>来源：MeasurementSource</p>
<p>MeasurementSource<br>MeasurementSource.MEASURESELECTION  选区<br>MeasurementSource.MEASURECOUNTTOOL  计数工具<br>MeasurementSource.MEASURERULERTOOL  标尺工具<br>数据点：string 数组</p>
<p>查看图片</p>
<p>autoCount( 通道, 阈值 )<br>自动计数。</p>
<p>通道：Channel<br>阈值：number</p>
<p>选区与通道<br>Selection<br>选区。</p>
<p>属性<br>bounds UnitValue 数组<br>选区边界位置，只读。[0,1,2,3] 分别是 0:左侧左边距 1:顶侧顶边距 2:右侧左边距 3:底侧顶边距。</p>
<p>查看图片</p>
<p>solid boolean<br>是否是矩形选区。</p>
<p>方法<br>clear()<br>清除选区内容。</p>
<p>contract( 收缩量 )<br>收缩选区。</p>
<p>收缩量： UnitValue</p>
<p>expand( 扩展量 )<br>扩展选区。</p>
<p>扩展量为： UnitValue</p>
<p>feather( 羽化量 )<br>羽化选区。</p>
<p>羽化量： UnitValue。</p>
<p>fill( 填充颜色, 混合模式, 不透明度, 保留透明区域 )<br>填充。</p>
<p>填充颜色：SolidColor<br>混合模式：ColorBlendMode<br>不透明度：number（0~100）<br>保留透明区域：boolean</p>
<p>查看图片</p>
<p>grow( 容差, 消除锯齿 )<br>扩展。</p>
<p>容差 number<br>消除锯齿 boolean</p>
<p>invert()<br>反选。</p>
<p>load( 通道, 选区操作, 反相 )<br>载入选区。从通道载入选区。</p>
<p>通道：Channel<br>选区操作：SelectionType</p>
<p>SelectionType.DIMINISH  从选区中减去<br>SelectionType.EXTEND  添加到选区<br>SelectionType.INTERSECT 与选区交叉<br>SelectionType.REPLACE 新建选区<br>反相：boolean</p>
<p>查看图片</p>
<p>makeWorkPath( 容差 )<br>建立工作路径。</p>
<p>查看图片</p>
<p>resize( 水平位置, 垂直位置, 锚点位置 )<br>自由变换，重设选区内容尺寸。</p>
<p>resizeBoundary( 水平位置, 垂直位置, 锚点位置 )<br>变换选区，重设选区尺寸。</p>
<p>水平位置：number<br>垂直位置：number<br>锚点位置：AnchorPosition</p>
<p>rotate(  角度, 锚点 )<br>旋转。</p>
<p>角度：number<br>锚点：AnchorPosition</p>
<p>resizeBoundary( 角度, 锚点 )<br>旋转选区。</p>
<p>角度：number<br>锚点：AnchorPosition</p>
<p>select( 区域, 操作, 羽化, 消除锯齿 )<br>创建选区。</p>
<p>区域是一个4个角的坐标数组：[左上, 右上, 右下, 左下] 操作可以是：</p>
<p>区域：number 数组<br>操作：SelectionType</p>
<p>SelectionType.DIMINISH  从选区中减去<br>SelectionType.EXTEND  添加到选区<br>SelectionType.INTERSECT 与选区交叉<br>SelectionType.REPLACE 新建选区<br>羽化：boolean<br>消除锯齿：boolean</p>
<p>app.activeDocument.selection.select([[0,0],[300,0],[555,100],[50,110]] ,SelectionType.REPLACE,0,false)<br>selectAll()<br>全选。</p>
<p>selectBorder( 宽度 )<br>边界选区。</p>
<p>宽度：UnitValue</p>
<p>查看图片</p>
<p>similar( 容差, 消除锯齿 )<br>选取相似。</p>
<p>容差：number<br>消除锯齿：boolean</p>
<p>smooth( 取样半径 )<br>取样半径：number</p>
<p>查看图片</p>
<p>store( 通道,  操作 )<br>存储选区。</p>
<p>通道：Channel<br>操作：SelectionType</p>
<p>查看图片</p>
<p>stroke( 描边颜色, 描边宽度,位置, 混合模式, 不透明度, 保持透明度区域 )<br>描边。<br>描边颜色：SolidColor<br>描边宽度：number<br>位置：StrokeLocation</p>
<p>StrokeLocation<br>StrokeLocation.CENTER 居中<br>StrokeLocation.INSIDE 内部<br>StrokeLocation.OUTSIDE  居外<br>混合模式：ColorBlendMode<br>不透明度：number<br>保持透明度区域：boolean</p>
<p>查看图片</p>
<p>translate( X 偏移值 , Y 偏移值 )<br>移动。移动选区内容位置。</p>
<p>translateBoundary( X 偏移值 , Y 偏移值 )<br>移动。移动选区位置。</p>
<p>copy( 复制所有可见图层 )<br>复制选区内容。如果“复制所有可见图层”参数为真，将复制选区下所有可见图层内容，否则只复制当前图层内容。</p>
<p>复制所有可见图层：boolean</p>
<p>cut()<br>剪切选区内容。</p>
<p>deselect()<br>取消选择。</p>
<p>Channel<br>通道。</p>
<p>属性<br>kind ChannelType<br>通道类型，即通道选项中色彩指示的选项。</p>
<p>ChannelType<br>ChannelType.COMPONENT 色彩模型相关的通道（如红、绿、蓝）<br>ChannelType.MASKEDAREA  被蒙版区域<br>ChannelType.SELECTEDAREA  所选区域<br>ChannelType.SPOTCOLOR 专色<br>查看图片</p>
<p>histogram number 数组<br>直方图。一个 256 个数的数组表示的直方图信息。只读。</p>
<p>name string<br>通道名称。</p>
<p>color SolidColor<br>颜色。通道颜色，如果通道类型是 ChannelType.COMPONENT：色彩模型相关的通道，颜色设置是无效的。</p>
<p>查看图片</p>
<p>opacity number<br>不透明度（0~100）。只有通道类型为 ChannelType.MASKEDAREA（被蒙版区域）和 ChannelType.SELECTEDAREA（所选区域）时才有效。</p>
<p>visible boolean<br>通道可视性。</p>
<p>方法<br>duplicate( 目标文档 )<br>复制通道，创建一个通道的副本到目标文档，如果不填目标文档参数，将创建到当前文档。</p>
<p>app.activeDocument.channels[0].duplicate(app.documents[1])<br>merge()<br>合并专色通道。只有通道类型是：ChannelType.SPOTCOLOR：专色才可用。</p>
<p>动作代理<br>脚本除了直接操作 DOM ，还有一种更加底层的操作宿主的方式：Action Manager ，与操作 DOM 不同，DOM 只是封装了宿主一部的操作，而动作代理几乎能完成所有宿主的操作。关于动作代理的使用，推荐去阅读文章：「 5 」 Photoshop ExtendScript 入门#动作代理</p>
<p>ActionDescriptor<br>动作描述符。</p>
<p>属性<br>count number<br>数量。描述中键值数量。</p>
<p>方法<br>clear()<br>清空描述符。</p>
<p>erase( 键)<br>清除一个键值。</p>
<p>键：number</p>
<p>boolean getBoolean( 键 )<br>取布尔值类型的键值。</p>
<p>键：number</p>
<p>number getClass( 键 )<br>取类类型的键值。</p>
<p>键：number</p>
<p>string getData( 键 )<br>取键值的原始数据的字节数据。</p>
<p>键：number</p>
<p>number getDouble( 键 )<br>取双精度浮点数类型的键值。</p>
<p>键：number</p>
<p>number getEnumerationType(键值)<br>取键值的枚举类型。</p>
<p>键：number</p>
<p>number getEnumerationValue(键值)<br>取键值的枚举值。</p>
<p>键：number</p>
<p>number getInteger(键)<br>取整数类型的键值。</p>
<p>键：number</p>
<p>number getKey( 索引号 )<br>根据索引号取键值。</p>
<p>索引号：number</p>
<p>number getLargeInteger(键)<br>取长整数类型的键值。</p>
<p>键：number</p>
<p>ActionList getList( 键 )<br>取动作列表类型的键值。</p>
<p>键：number</p>
<p>number getObjectType(键值)<br>获取一个键值对象的类标识( class ID)</p>
<p>键：number</p>
<p>ActionDescriptor getObjectValue( 键 )<br>获取一个键值的对象。</p>
<p>键：number</p>
<p>File getPath(键)<br>取路径类型的键值。</p>
<p>键：number</p>
<p>ActionReference getReference(键)<br>获取键值对应的动作参数。</p>
<p>键：number</p>
<p>string getString(键)<br>获取键值对应的字符串。</p>
<p>键：number</p>
<p>DescValueType getType(键值)<br>获取键的类型</p>
<p>键：number</p>
<p>描述符值类型。</p>
<p>DescValueType<br>DescValueType.ALIASTYPE 别名类型<br>DescValueType.BOOLEANTYPE 布尔值类型<br>DescValueType.CLASSTYPE 类<br>DescValueType.DOUBLETYPE  双精度浮点数类型<br>DescValueType.ENUMERATEDTYPE  枚举类型<br>DescValueType.INTEGERTYPE 整数类型<br>DescValueType.LARGEINTEGERTYPE  长整数类型<br>DescValueType.LISTTYPE  列表类型<br>DescValueType.OBJECTTYPE  对象类型<br>DescValueType.RAWTYPE 原始数据类型<br>DescValueType.REFERENCETYPE 动作参数类型<br>DescValueType.STRINGTYPE  字符串类型<br>DescValueType.UNITDOUBLE  单位偶<br>number getUnitDoubleType(键)<br>取单位偶的单位类型。</p>
<p>键：number</p>
<p>number getUnitDoubleValue(键)<br>取单位偶的单位类型。</p>
<p>键：number</p>
<p>boolean hasKey( 键 )<br>检查描述符是否有键。</p>
<p>键：number</p>
<p>boolean isEqual(动作描述符)<br>与另一个动作描述符比较是否相等，相等返回真。</p>
<p>动作描述符：</p>
<p>putBoolean(键, 值)<br>添加一个布尔值类型的键值。</p>
<p>键：number<br>值：boolean</p>
<p>putClass(键, 值)<br>添加一个类类型的键值。</p>
<p>键：number<br>值：number</p>
<p>putData(键, 值)<br>添加一个原始数据类型的键值。</p>
<p>键：number<br>值：string</p>
<p>putEnumerated(键, 枚举类型, 值)<br>添加一个枚举键值。</p>
<p>键：number<br>枚举类型：number<br>值：number</p>
<p>putInteger( 键, 值 )<br>添加一个整数类型的键值。</p>
<p>键：number<br>值：number</p>
<p>putLargeInteger( 键, 值 )<br>添加一个长整数类型的键值。</p>
<p>键：number<br>值：number</p>
<p>putList(键, 值)<br>添加一个列表类型的键值。</p>
<p>键：number<br>值：ActionList</p>
<p>putObject(键, 类ID, 值)<br>添加一个对象类型的键值。</p>
<p>键：number<br>类 ID (classID)：number<br>值：ActionDescriptor</p>
<p>putPath( 键, 值 )<br>添加一个文件路径类型的键值。</p>
<p>键：number<br>值：File</p>
<p>putReference(键, 值)<br>添加一个动作参数类型的键值。</p>
<p>键：number<br>值：ActionReference</p>
<p>putString(键, 值)<br>添加一个字符串类型的键值。</p>
<p>键：number<br>值：string</p>
<p>putUnitDouble(键, 单位 ID, 值)<br>添加一个单位偶键值。</p>
<p>键：number<br>单位 ID：number<br>值：number</p>
<p>string toStream()<br>生成标识符的字节流。用以把标识符保存为文件。</p>
<p>fromStream( 值 )<br>从字节流读取描述符。用从文件中载入标识符。</p>
<p>值：string</p>
<p>ActionReference<br>动作参考。</p>
<p>方法<br>ActionReference getContainer()<br>获取一个包含此动作参考的容器。</p>
<p>number getDesiredClass()<br>获取请求类。</p>
<p>number getEnumeratedType()<br>获取枚举类型。</p>
<p>number getEnumeratedValue()<br>获取枚举值。</p>
<p>ReferenceFormType getForm()<br>获取此动作参考的应用类型。</p>
<p>ReferenceFormType<br>ReferenceFormType.CLASSTYPE 类类型<br>ReferenceFormType.ENUMERATED  枚举类型<br>ReferenceFormType.IDENTIFIER  标识符<br>ReferenceFormType.INDEX 索引<br>ReferenceFormType.NAME  名称<br>ReferenceFormType.OFFSET  偏移值<br>ReferenceFormType.PROPERTY  属性<br>number getIdentifier()<br>获取标识符值。</p>
<p>number getIndex()<br>获取索引号。</p>
<p>string getName()<br>获取名称。</p>
<p>number getOffset()<br>获取偏移值。</p>
<p>number getProperty()<br>获取属性 ID 值。</p>
<p>putClass ( 请求类 )<br>添加请求类。</p>
<p>请求类：number</p>
<p>putEnumerated( 请求类, 列举类型, 值 )<br>添加枚举值。</p>
<p>请求类：number<br>列举类型：number<br>值：number</p>
<p>putIdentifier( 请求类, 值 )<br>添加标识符。</p>
<p>请求类：number<br>值：number</p>
<p>putIndex( 请求类, 值)<br>添加索引。</p>
<p>请求类：number<br>值：number</p>
<p>putName( 请求类, 值)<br>添加名称。</p>
<p>请求类：number<br>值：number</p>
<p>putOffset( 请求类, 值 )<br>添加偏移值。</p>
<p>请求类：number<br>值：number</p>
<p>putProperty( 请求类 , 值)<br>添加属性。</p>
<p>请求类：number<br>值：number</p>
<p>ActionList<br>动作列表，类似于数组的数据存储对象，不过只能添加成员数据，不能修改已经添加的数据，除非清空列表重新添加。</p>
<p>属性<br>number count<br>列表成员数。</p>
<p>方法<br>boolean getBoolean( 索引号 )<br>取布尔值类型的指定列表元素。</p>
<p>number getClass( 索引号 )<br>取类类型的指定列表元素。</p>
<p>string getData( 索引号 )<br>取的指定列表元素的原始数据。</p>
<p>string getDouble( 索引号 )<br>取双精度浮点类型的指定列表元素。</p>
<p>string getEnumerationType( 索引号 )<br>取枚举类型的指定列表元素。</p>
<p>number getEnumerationValue( 索引号 )<br>取指定列表元素的枚举值。</p>
<p>number getInteger( 索引号 )<br>取指定列表元素的枚举值。</p>
<p>数据类型与常数<br>Documents<br>属性<br>length number<br>长度。documents 合集中 document 的数量。</p>
<p>方法<br>add ( 宽带, 高度, 分辨率, 名称, 文档颜色模式, 背景内容, 像素长宽比, 颜色位数, 色彩管理 )<br>新建一个文档。</p>
<p>宽度： UnitValue<br>高度： UnitValue<br>分辨率：number<br>名称：string<br>文档颜色模式：NewDocumentMode</p>
<p>NewDocumentMode.BITMAP  位图<br>NewDocumentMode.CMYK  CMYK 颜色<br>NewDocumentMode.GRAYSCALE 灰度<br>NewDocumentMode.LAB Lab 颜色<br>NewDocumentMode.RGB RGB 颜色<br>背景内容：DocumentFill</p>
<p>DocumentFill.BACKGROUNDCOLOR  拾色器背景颜色<br>DocumentFill.TRANSPARENT  透明背景<br>DocumentFill.WHITE  白色背景<br>像素长宽比：number（默认为1）</p>
<p>查看图片</p>
<p>颜色位数：BitsPerChannelType</p>
<p>BitsPerChannelType.EIGHT  8 位（默认）<br>BitsPerChannelType.ONE  1 位<br>BitsPerChannelType.SIXTEEN  16 位<br>BitsPerChannelType.THIRTYTWO  32 位<br>色彩管理：string （色彩配置文件名称）</p>
<p>Document getByName( 名称 )<br>根据名称取文档。查找并返回指定名称的文档。</p>
<p>File<br>文件。File 是非常重要的对象，打开文件、存储文件等都需要使用 File 处理路径。</p>
<p>属性<br>fsName string<br>当前系统文件风格的完整路径。只读。</p>
<p>D:\Creative\Adobe\Adobe Photoshop CC 2015\Photoshop.exe<br>fullName string<br>完整路径。只读。</p>
<p>&#x2F;d&#x2F;Creative&#x2F;Adobe&#x2F;Adobe Photoshop CC 2015&#x2F;Photoshop.exe<br>absoluteURI string<br>绝对 URI 路径。完整路径转义后的 URI 形式。只读。</p>
<p>&#x2F;d&#x2F;Creative&#x2F;Adobe&#x2F;Adobe%20Photoshop%20CC%202015&#x2F;Photoshop.exe<br>relativeURI string<br>相对 URI 路径。文件相对于当前文件夹的 URI 路径。只读。</p>
<p>&#x2F;&#x2F;当前目录是：D:\Creative\Adobe\Adobe Photoshop CC 2015\ 时：<br>Photoshop.exe<br>name string<br>文件名（完整路径）。转义后的 URI 形式。只读。</p>
<p>&#x2F;d&#x2F;Creative&#x2F;Adobe&#x2F;Adobe%20Photoshop%20CC%202015&#x2F;Photoshop.exe<br>displayName   string<br>显示文件名。本地显示的文件名，（不包括路径）。 只读。</p>
<p>Photoshop.exe<br>path string<br>文件所在目录的路径。</p>
<p> &#x2F;d&#x2F;Creative&#x2F;Adobe&#x2F;Adobe%20Photoshop%20CC%202015<br>alias boolean<br>别名。如果为真则说明这个文件是一个操作系统别名或快捷方式。只读。</p>
<p>created Date<br>文件创建日期。如果为空说明此文件是未创建的。只读。</p>
<p>modified Data<br>文件最后修改日期。只读。</p>
<p>creator string<br>创造者。只对 OS X 系统有效。 Windows  下为 “????”。只读。</p>
<p>displayName   string<br>显示文件名。本地显示的文件名，（不包括路径）。 只读。</p>
<p>encoding  string<br>读写编码设置。</p>
<p>eof boolean<br>文件当前读写位置是否位于文件结束位置。只读。</p>
<p>error string<br>文件系统错误记录。</p>
<p>exists boolean<br>文件是否存在。只读。</p>
<p>hidden boolean<br>是否隐藏文件。</p>
<p>length number<br>文件长度（字节）。可修改，修改长度会用填 0 字节或截断文件来处理。</p>
<p>lineFeed string<br>换行类型。”Windows”、 “Macintosh”、 “Unix”。</p>
<p>readonly boolean<br>文件只读。</p>
<p>type string<br>文件类型。</p>
<p>方法<br>changePath( 路径 )<br>改变文件路径。</p>
<p>路径：string</p>
<p>close()<br>关闭文件。</p>
<p>copy( 目的地 )<br>复制当前文件到目的地，如果存在同名文件，则会覆盖。</p>
<p>目的地：string</p>
<p>createAlias( 路径 )<br>创建别名。</p>
<p>路径：string</p>
<p>execute ()<br>运行。在操作系统中打开文件，或运行程序。</p>
<p>open(读写模式，类型，创造者)</p>
<p>打开文件。类型和创造者是仅在 OS X 中使用的。Windows 下没用。</p>
<p>读写模式：string</p>
<p>r 仅读取。文件不存在会报错。<br>w 仅写入。如果文件存在会清空内容，不存在会创建新文件<br>e 编辑。读写一个已经存在的文件。<br>a 添加。在一个文件末尾读写。<br>类型：string</p>
<p>创造者：string</p>
<p>getRelativeURI( 根目录 )<br>取相对 URI 路径。以指定的根目录为参考，计算出相对 URI 路径。</p>
<p>根目录：string</p>
<p>File 或 File 数组 openDialog( 提示文本, 过滤器, 允许多选 )<br>弹出打开文件窗口。过滤器示例（windows）：”Javascript files:<em>.jsx;All files:</em>.*”。</p>
<p>提示文本：string<br>过滤器：string 或 function<br>允许多选：boolean</p>
<p> var a &#x3D; File.openDialog(“打开一个文件”,);<br>查看图片</p>
<p>File saveDialog( 提示文本, 过滤器 )<br>弹出保存文件窗口。过滤器示例（windows）：”Javascript files:.jsx;All files:.*”。</p>
<p>提示文本：string<br>过滤器：string 或 function</p>
<p>string  read( 字符数 )<br>读取指定字符数文件。不提供字符数参数则读取全部内容。</p>
<p>string readch()<br>读取当前位置一个字符。</p>
<p>string readln()<br>读取当前位置一行。</p>
<p>boolean  write( 文本 )<br>在当前读写位置写入文本。</p>
<p>文本：string </p>
<p>boolean writeln( 文本 )<br>在当前读写位置写入一行文本。会自动在末尾添加一个换行符。</p>
<p>文本：string</p>
<p>seek( 偏移值, 模式 )<br>移动当前读写位置到指定指定位置。模式 0：位置从 0 开始。模式 1：从当前位置开始。模式 2 ：从结束位置逆序。</p>
<p>偏移值：number<br>模式：number</p>
<p>number  tell ()<br>查询当前读写位置。</p>
<p>string toSource ()<br>转换为代码。把当前文件转换为一段代码文本，使用  eval() 函数执行这段代码就能载入这个文件。</p>
<p>转换后的代码示例：</p>
<p>new File (“&#x2F;d&#x2F;DC_New_Hero_29K45.w3x”)<br>File.toString (): string Core JavaScript Classes Converts this object to a string.</p>
<p>File  resolve ()<br>解析路径。如果当前文件是快捷方式或别名，返回一个其指向的实际文件的 File 对象。</p>
<p>boolean rename( 新文件名 )<br>重命名。</p>
<p>新文件名：string </p>
<p>remove ()<br>删除文件。</p>
<p>LayerComps<br>图层复合合集。</p>
<p>属性<br>length number<br>图层复合数量。</p>
<p>方法<br>add( 名称, 注释, 外观, 位置, 可视性)<br>创建一个图层复合。</p>
<p>removeAll()<br>移除全部。</p>
<p>LayerComp<br>图层复合。</p>
<p>属性<br>appearance boolean<br>图层复合是否适用于内容：外观（图层样式）。</p>
<p>position boolean<br>图层复合是否适用于内容：位置。</p>
<p>visibility boolean<br>图层复合是否适用于内容：可见性。</p>
<p>comment string<br>注释。</p>
<p>name string<br>名称。</p>
<p>selected boolean<br>是否被选择。</p>
<p>查看图片</p>
<p>方法<br>apply()<br>应用图层复合。</p>
<p>recapture()<br>更新图层复合。</p>
<p>ColorSampler<br>色彩采样点。</p>
<p>查看图片</p>
<p>属性<br>color SolidColor<br>采集到的颜色。</p>
<p>position UnitValue 数组<br>位置 [x,y]。</p>
<p>方法<br>move( [位置] )<br>移动。</p>
<p>位置： UnitValue 数组</p>
<p>remove()<br>移除此采样点。</p>
<p>UnitValue<br>单位值。 表示一个数值，此值的单位可以是 mm 、cm、px 等，在取得图层的相关数据的单位值时，其单位取决于首选项里的标尺单位设置。</p>
<p>Photoshop 首选项的单位设置</p>
<p>而使用 UnitValue(单位值字符串) 可以创建一个单位值：</p>
<p>var a &#x3D; UnitValue(“22 px”)<br>单位名可以是：</p>
<p>像素  px  点 pt<br>英寸  in  派卡  pc<br>厘米  cm  百分比 %<br>毫米  mm<br>UnitValue 有用于转换的 as() 和 convert() 方法：</p>
<p>as(单位名) 可以返回一个指定单位的单位值，原变量单位不变。<br>convert(单位名) 把原单位值转换成指定单位，转换成功返回真。<br>var a &#x3D; UnitValue(“22 px”)<br>a.convert (“cm”) &#x2F;&#x2F; true<br>a &#x2F;&#x2F; 0.77611111111111 cm<br>var b &#x3D; UnitValue(“22 px”)<br>b.as(“cm”) &#x2F;&#x2F;0.77611111111111<br>b &#x2F;&#x2F;22 px<br>SolidColor<br>通用颜色，存储和表示颜色，有 cmyk, gray(灰度), hsb, lab, rgb 的属性用来输入和输出色彩。</p>
<p>另外通过 nearestWebColor 属性获得 Web安全色，model 属性更改和获取 rgb 色彩空间。</p>
<p>&#x2F;&#x2F;RGBColor<br>rgb.red &#x3D; 255 &#x2F;&#x2F;[0<del>255]<br>rgb.green &#x3D; 111 &#x2F;&#x2F;[0</del>255]<br>rgb.blue &#x3D; 200 &#x2F;&#x2F;[0<del>255]<br>rgb.hexValue  &#x3D; “FFEEAA”<br>&#x2F;&#x2F;CMYKColor<br>cmyk.black &#x3D; 40 &#x2F;&#x2F;[0.0100.00]<br>cmyk.cyan &#x3D; 20 &#x2F;&#x2F;[0.0100.00]<br>cmyk.magenta &#x3D; 20 &#x2F;&#x2F;[0.0100.00]<br>cmyk.yellow &#x3D; 10 &#x2F;&#x2F;[0.0100.00]<br>&#x2F;&#x2F;GrayColor<br>gray.gray &#x3D; 40 &#x2F;&#x2F;[0.0</del>100.00]<br>&#x2F;&#x2F;HSBColor<br>hsb.brightness &#x3D; 12&#x2F;&#x2F;[0.0100.00]<br>hsb.hue &#x3D; 120 &#x2F;&#x2F;[0.0360.00]<br>hsb.saturation &#x3D; 100 &#x2F;&#x2F;[0.0<del>100.00]<br>&#x2F;&#x2F;LabColor<br>lab.l &#x3D; 20 &#x2F;&#x2F;[0.0100.0]<br>lab.a &#x3D; 20 &#x2F;&#x2F;[-128.0127.0]<br>lab.b&#x3D; 30 &#x2F;&#x2F;[-128.0</del>127.0]<br>可以通过  boolean isEqual( SolidColor ) 方法比较 2 个颜色是否相等：</p>
<p>var c &#x3D; new SolidColor();<br>c.rgb.hexValue &#x3D; “ffeeff”;<br>var a &#x3D; new SolidColor();<br>a.rgb.hexValue &#x3D; “ffee2f”;<br>c.isEqual(a); &#x2F;&#x2F; false<br>AnchorPosition<br>锚点位置。</p>
<p>AnchorPosition.BOTTOMCENTER 正下<br>AnchorPosition.BOTTOMLEFT 左下<br>AnchorPosition.BOTTOMRIGHT  右下<br>AnchorPosition.MIDDLECENTER 正中<br>AnchorPosition.MIDDLELEFT 左中<br>AnchorPosition.MIDDLERIGHT  右中<br>AnchorPosition.TOPCENTER  正上<br>AnchorPosition.TOPLEFT  左上<br>AnchorPosition.TOPRIGHT 右下<br>BitmapConversionOptions<br>位图转换选项。</p>
<p>method BitmapConversionType<br>转换方法。</p>
<p>BitmapConversionType.CUSTOMPATTERN  自定图案<br>BitmapConversionType.DIFFUSIONDITHER  扩散仿色<br>BitmapConversionType.HALFTHRESHOLD  50%阈值<br>BitmapConversionType.HALFTONESCREEN 半调网屏<br>BitmapConversionType.PATTERNDITHER  图案仿色<br>frequency number<br>半调网屏方法时的频率。</p>
<p>查看图片</p>
<p>angle number<br>半调网屏方法时的角度 (-180~180)。</p>
<p>shape BitmapHalfToneType<br>半调网屏方法时的形状。</p>
<p>BitmapHalfToneType.CROSS  十字线<br>BitmapHalfToneType.DIAMOND  菱形<br>BitmapHalfToneType.ELLIPSE  椭圆<br>BitmapHalfToneType.LINE 直线<br>BitmapHalfToneType.ROUND  圆<br>BitmapHalfToneType.SQUARE 正形<br>patternName string<br>自定义图案方法时的图案名称。</p>
<p>BMPSaveOptions<br>alphaChannels boolean<br>为真保存 alpha 通道。</p>
<p>depth BMPDepthType<br>深度。</p>
<p>BMPDepthType<br>BMPDepthType.BMP_A1R5G5B5 查看图片<br>BMPDepthType.BMP_A4R4G4B4<br>BMPDepthType.BMP_A8R8G8B8<br>BMPDepthType.BMP_R5G6B5<br>BMPDepthType.BMP_R8G8B8<br>BMPDepthType.BMP_X1R5G5B5<br>BMPDepthType.BMP_X4R4G4B4<br>BMPDepthType.BMP_X8R8G8B8<br>BMPDepthType.EIGHT<br>BMPDepthType.FOUR<br>BMPDepthType.ONE<br>BMPDepthType.SIXTEEN<br>BMPDepthType.THIRTYTWO<br>BMPDepthType.TWENTYFOUR<br>flipRowOrder boolean<br>翻转行序。</p>
<p>osType OperatingSystem<br>系统类型。</p>
<p>OperatingSystem<br>OperatingSystem.OS2 OS2<br>OperatingSystem.WINDOWS Windows<br>rleCompression boolean<br>使用 RLE 压缩，只在 osType 为 OperatingSystem.WINDOWS 时有效。</p>
<p>GIFSaveOptions<br>colors number<br>色彩数。</p>
<p>dither Dither<br>仿色算法。</p>
<p>Dither<br>Dither.NONE 无仿色<br>Dither.DIFFUSION  扩散<br>Dither.NOISE  杂色<br>Dither.PATTERN  图案<br>ditherAmount number<br>仿色数量。</p>
<p>forced ForcedColors<br>强制。</p>
<p>ForcedColors.BLACKWHITE 黑白<br>ForcedColors.NONE 无<br>ForcedColors.PRIMARIES  三原色<br>ForcedColors.WEB  Web<br>interlaced boolean<br>交错。</p>
<p>matte MatteType<br>杂边。</p>
<p>MatteType.BACKGROUND  背景色<br>MatteType.BLACK 黑色<br>MatteType.FOREGROUND  前景色<br>MatteType.NETSCAPE  Netscape 灰<br>MatteType.NONE  无<br>MatteType.SEMIGRAY  50% 灰<br>MatteType.WHITE 白<br>palette PaletteType<br>调板。</p>
<p>PaletteType.EXACT 实际<br>PaletteType.LOCALADAPTIVE 局部（随样性）<br>PaletteType.LOCALPERCEPTUAL 局部（可感知）<br>PaletteType.LOCALSELECTIVE  局部（可选择）<br>PaletteType.MACOSPALETTE  系统（Mac OS）<br>PaletteType.MASTERADAPTIVE  全部（随样性）<br>PaletteType.MASTERPERCEPTUAL  全部（可感知）<br>PaletteType.MASTERSELECTIVE 全部（可选择）<br>PaletteType.PREVIOUSPALETTE 上一个<br>PaletteType.UNIFORM 平均<br>PaletteType.WEBPALETTE  Web<br>PaletteType.WINDOWSPALETTE  系统（Windows）<br>查看图片</p>
<p>preserveExactColors boolean<br>保留实际颜色，当仿色为扩撒时有效。</p>
<p>transparency boolean<br>透明度。</p>
<p>JPEGSaveOptions<br>查看图片</p>
<p>embedColorProfile boolean<br>嵌入色彩配置文件。</p>
<p>formatOptions FormatOptions<br>FormatOptions.OPTIMIZEDBASELINE 基线已优化<br>FormatOptions.PROGRESSIVE 连续<br>FormatOptions.STANDARDBASELINE  基线（”标准”）<br>scans number<br>扫描。</p>
<p>matte MatteType<br>杂边。</p>
<p>quality number<br>品质（0~12）。</p>
<p>查看图片</p>
<p>PNGSaveOptions<br>compression number<br>压缩 （0-9）。</p>
<p>interlaced boolean<br>交错。</p>
<p>BlendMode<br>混合模式。</p>
<p>BlendMode.NORMAL  正常<br>BlendMode.DISSOLVE  溶解<br>BlendMode.DARKEN  变暗<br>BlendMode.MULTIPLY  正片叠底<br>BlendMode.COLORBURN 颜色加深<br>BlendMode.LINEARBURN  线性加深<br>BlendMode.COLORBLEND  颜色<br>BlendMode.COLORDODGE  颜色减淡<br>BlendMode.DIFFERENCE  差分<br>BlendMode.LIGHTEN 变亮<br>BlendMode.SCREEN  滤色<br>BlendMode.LINEARDODGE 线性减淡<br>BlendMode.DIVIDE  划分<br>BlendMode.EXCLUSION 排除<br>BlendMode.HARDLIGHT 强光<br>BlendMode.HARDMIX 实色混合<br>BlendMode.HUE 色调<br>BlendMode.LINEARLIGHT 线性光<br>BlendMode.LUMINOSITY  明度<br>BlendMode.OVERLAY 叠加<br>BlendMode.PASSTHROUGH 穿透<br>BlendMode.PINLIGHT  点光<br>BlendMode.SATURATION  饱和度<br>BlendMode.SOFTLIGHT 柔光<br>BlendMode.SUBTRACT  减去<br>BlendMode.VIVIDLIGHT  亮光<br>ExportOptionsSaveForWeb<br>存储为 Web 所用格式所用选项。</p>
<p>blur number<br>模糊图像，默认 0.0 不模糊。</p>
<p>colorReduction ColorReductionType<br>减低颜色深度算法。</p>
<p>olorReductionType.PERCEPTUAL  可感知<br>ColorReductionType.SELECTIVE  可选择<br>ColorReductionType.ADAPTIVE 随样性<br>ColorReductionType.RESTRICTIVE  受限<br>ColorReductionType.CUSTOM 自定义<br>ColorReductionType.BLACKWHITE 黑 – 白<br>ColorReductionType.GRAYSCALE  灰度<br>ColorReductionType.MACINTOSH  Mac OS<br>ColorReductionType.WINDOWS  Windows<br>查看图片</p>
<p>colors number<br>颜色数。默认 256。</p>
<p>dither Dither<br>仿色算法。</p>
<p>Dither<br>Dither.NONE 无仿色<br>Dither.DIFFUSION  扩散<br>Dither.NOISE  杂色<br>Dither.PATTERN  图案<br>查看图片</p>
<p>ditherAmount number<br>仿色数量，当仿色设置为“Dither.DIFFUSION：扩散”的时候有效，指定扩散的大小。</p>
<p>format SaveDocumentType<br>导出格式。可以使用下面 4 种。</p>
<p>SaveDocumentType.COMPUSERVEGIF  GIF<br>SaveDocumentType.BMP  BMP<br>SaveDocumentType.PNG  PNG<br>SaveDocumentType.JPEG JPEG<br>includeProfile boolean<br>嵌入颜色配置文件。</p>
<p>查看图片</p>
<p>interlaced boolean<br>交错。</p>
<p>查看图片</p>
<p>lossy number<br>损耗。允许数据丢失的数量，默认为 0。</p>
<p>matteColor RGBColor<br>杂边。杂边颜色。</p>
<p>optimized boolean<br>优化，导出 JPEG 格式时可用。</p>
<p>查看图片</p>
<p>PNG8 boolean<br>为真保存为 PNG8 ，否则保存为 PNG24。</p>
<p>quality number<br>品质 。（0~100）。</p>
<p>transparency boolean<br>透明度。是否存储图像透明度，导出为 GIF 或 PNG 时有效。</p>
<p>transparencyDither Dither<br>透明度仿色算法。</p>
<p>Dither<br>Dither.NONE 无仿色<br>Dither.DIFFUSION  扩散<br>Dither.NOISE  杂色<br>Dither.PATTERN  图案<br>transparencyAmount number<br>透明度仿色数量。当透明度仿色设置为 Dither.DIFFUSION：扩撒 的时候有效，指定扩撒的大小。</p>
<p>webSnap number<br>Web 靠色。</p>
<p>查看图片</p>
<p>ElementPlacement<br>相对位置。</p>
<p>ElementPlacement.INSIDE 插入图层组<br>ElementPlacement.PLACEATBEGINNING 图层组首位<br>ElementPlacement.PLACEATEND 图层组末位<br>ElementPlacement.PLACEBEFORE  之前<br>ElementPlacement.PLACEAFTER 之后<br>Direction<br>文本取向。</p>
<p>Direction.HORIZONTAL  水平<br>Direction.VERTICAL  垂直<br>RasterizeType<br>栅格化类型。</p>
<p>RasterizeType.ENTIRELAYER 栅格化图层<br>RasterizeType.FILLCONTENT 栅格化填充内容（生成矢量蒙版）<br>RasterizeType.LAYERCLIPPINGPATH 栅格化矢量蒙版<br>RasterizeType.TEXTCONTENTS  栅格化文字<br>RasterizeType.LINKEDLAYERS  栅格化链接的图层<br>RasterizeType.SHAPE 栅格化形状<br>Guide<br>参考线。<br>direction Direction</p>
<p>参考线方向。</p>
<p>Direction<br>Direction.HORIZONTAL  水平<br>Direction.VERTICAL  垂直<br>coordinate UnitValue<br>参考线方向。</p>
<p>activeDocument.guides.add (Direction.HORIZONTAL,UnitValue(“333px”))</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-20220808-Manim入门教程"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/08/08/20220808-Manim%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"
    >20220808-Manim入门教程</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/08/08/20220808-Manim%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/" class="article-date">
  <time datetime="2022-08-08T07:21:07.000Z" itemprop="datePublished">2022-08-08</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>git clone <a target="_blank" rel="noopener" href="https://github.com/leekunhwee/manim.git">https://github.com/leekunhwee/manim.git</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#假设文件保存为text.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> manimlib.imports <span class="keyword">import</span> *  <span class="comment">#引用包，后续代码该行默认有</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#动画执行指令</span></span><br><span class="line"><span class="comment">#python3 -m manim text.py BasicWrite -pl</span></span><br><span class="line"><span class="comment">#最基本的写字</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BasicWrite</span>(<span class="title class_ inherited__">Scene</span>): </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">construct</span>(<span class="params">self</span>): </span><br><span class="line">        <span class="comment">#text = TextMobject(&quot;Hello, I am dodo&quot;)</span></span><br><span class="line">        text = TextMobject(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            text,</span></span><br><span class="line"><span class="string">            $\\frac&#123;a&#125;&#123;d&#125;$,  #行内公式</span></span><br><span class="line"><span class="string">            $$a^2+d^2=o^2$$  #自动换行的公式</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span>)</span><br><span class="line">        self.play(Write(text))  <span class="comment">#逐个字母写出text内容</span></span><br><span class="line">        <span class="comment">#self.add(text)  #一次性直接出现所有字母</span></span><br><span class="line">        <span class="comment">#self.remove(text)  #一次性删除字符串</span></span><br><span class="line">        self.wait(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#动画执行指令</span></span><br><span class="line"><span class="comment">#python3 -m manim text.py TextWithPosition -pl</span></span><br><span class="line"><span class="comment">#在不同位置写字</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TextWithPosition</span>(<span class="title class_ inherited__">Scene</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">construct</span>(<span class="params">self</span>):</span><br><span class="line">        text = TextMobject(<span class="string">&quot;Andodo&quot;</span>)</span><br><span class="line">        text.to_edge(UP)</span><br><span class="line">        <span class="comment">#text.to_edge(DOWN)</span></span><br><span class="line">        <span class="comment">#text.to_edge(Right)</span></span><br><span class="line">        <span class="comment">#text.to_edge(LEFT)</span></span><br><span class="line">        <span class="comment">#text.to_edge(UP+RIGHT)</span></span><br><span class="line">        <span class="comment">#text.to_edge(UP+LEFT)</span></span><br><span class="line">        <span class="comment">#text.to_edge(RIGHT+DOWN)</span></span><br><span class="line">        <span class="comment">#text.to_edge(LEFT+DOWN)</span></span><br><span class="line">        self.play(Write(text))</span><br><span class="line">        self.wait(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure> 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-20220806-好用的本地视频播放器推荐"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/08/06/20220806-%E5%A5%BD%E7%94%A8%E7%9A%84%E6%9C%AC%E5%9C%B0%E8%A7%86%E9%A2%91%E6%92%AD%E6%94%BE%E5%99%A8%E6%8E%A8%E8%8D%90/"
    >20220806-好用的本地视频播放器推荐</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/08/06/20220806-%E5%A5%BD%E7%94%A8%E7%9A%84%E6%9C%AC%E5%9C%B0%E8%A7%86%E9%A2%91%E6%92%AD%E6%94%BE%E5%99%A8%E6%8E%A8%E8%8D%90/" class="article-date">
  <time datetime="2022-08-06T09:14:13.000Z" itemprop="datePublished">2022-08-06</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>windows potplayer 官网 <a target="_blank" rel="noopener" href="http://potplayer.tv/?lang=zh_CN">http://potplayer.tv/?lang=zh_CN</a></p>
<p>mac OmniPlayer </p>
<p>chorme 扩展 Darker Reader</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-20220806-windows-cmd中的函数使用"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/08/06/20220806-windows-cmd%E4%B8%AD%E7%9A%84%E5%87%BD%E6%95%B0%E4%BD%BF%E7%94%A8/"
    >20220806-windows_cmd中的函数使用</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/08/06/20220806-windows-cmd%E4%B8%AD%E7%9A%84%E5%87%BD%E6%95%B0%E4%BD%BF%E7%94%A8/" class="article-date">
  <time datetime="2022-08-06T06:56:36.000Z" itemprop="datePublished">2022-08-06</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>本文主要讲述如下几个问题：</p>
<p>   1.什么是函数，怎么创建函数？</p>
<p>   2.怎么调用一个函数？</p>
<p>   3.函数是怎么工作的？</p>
<p>   4.怎么向函数传递参数？</p>
<p>   5.函数怎么返回值和返回一个局部变量的值。</p>
<p>一、创建函数（什么是函数）</p>
<pre><code>在batch script 中的函数以一个标签开始，并以goto:eof结束，如下：
</code></pre>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> script</span><br><span class="line"></span><br><span class="line">:myDosFunc    - 函数的开始，用一个标签标识</span><br><span class="line">echo. 函数体，可以执行很多命令</span><br><span class="line">echo. </span><br><span class="line">GOTO:EOF</span><br></pre></td></tr></table></figure>
<p>二、调用函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Script: 01.</span><br><span class="line"> call:myDosFunc</span><br></pre></td></tr></table></figure>
<p>三、函数怎么工作</p>
<p>  调用函数的脚本将其分成两部分。</p>
<pre><code>1.main script: 从第一行开始并且以 GOTO:EOF命令结束

2.函数部分:由多个函数组成，由main script调用。
</code></pre>
<p>   SCRIPT：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">echo.开始调用函数</span><br><span class="line">call:myDosFunc</span><br><span class="line">echo.从函数返回myDosFunc</span><br><span class="line">echo.&amp;pause&amp;goto:eof</span><br><span class="line">::--------------------------------------------------------</span><br><span class="line">::-- 函数部分开始</span><br><span class="line">::--------------------------------------------------------</span><br><span class="line">:myDosFunc    - here starts my function identified by it`s label</span><br><span class="line">echo.  here the myDosFunc function is executing a group of commands</span><br><span class="line">echo.  it could do a lot of things</span><br><span class="line">goto:eof</span><br></pre></td></tr></table></figure>
<p>三、怎么传递参数，并且在函数中获取参数的值</p>
<p>   1.用空格或者逗号将参数分开</p>
<p>   2.用双引号将带有空格的字符串参数括起来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">call:myDosFunc 100 YeePEE</span><br><span class="line">call:myDosFunc 100 &quot;for me&quot;</span><br><span class="line">call:myDosFunc 100,&quot;for me&quot;</span><br></pre></td></tr></table></figure>

<p>   获取参数，采用%1~%9来获取每个参数的值。%0,表示批处理文件本身</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> :myDosFunc    - here starts myDosFunc identified by it`s label</span><br><span class="line">echo.</span><br><span class="line">echo. here the myDosFunc function is executing a group of commands</span><br><span class="line">echo. it could do %~1 of things %~2.</span><br><span class="line">goto:eof</span><br></pre></td></tr></table></figure>


<p> 带参数的脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> @echo off</span><br><span class="line">echo.going to execute myDosFunc with different arguments</span><br><span class="line">call:myDosFunc 100 YeePEE</span><br><span class="line">call:myDosFunc 100 &quot;for me&quot;</span><br><span class="line">call:myDosFunc 100,&quot;for me&quot;</span><br><span class="line">call:myDosFunc 100,for me</span><br><span class="line">echo.&amp;pause&amp;goto:eof</span><br><span class="line">::--------------------------------------------------------</span><br><span class="line">::-- Function section starts below here</span><br><span class="line">::--------------------------------------------------------</span><br><span class="line">:myDosFunc    - here starts my function identified by it&#x27;s label</span><br><span class="line">echo.</span><br><span class="line">echo. here the myDosFunc function is executing a group of commands</span><br><span class="line">echo. it could do %~1 of things %~2.</span><br><span class="line">goto:eof</span><br></pre></td></tr></table></figure>
<p>四、函数返回值</p>
<p>   1、调用命令不像其他语言那样能有返回值，最常用的做法是在函数中将该值保存在全局变量中，调用结束后</p>
<p>直接用该全局变量。如下：</p>
<p>  Usage:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> set &quot;var1=some hopefully not important string&quot;</span><br><span class="line">echo.var1 before: %var1%</span><br><span class="line">call:myGetFunc</span><br><span class="line">echo.var1 after : %var1%</span><br><span class="line">Script:</span><br><span class="line"></span><br><span class="line"> :myGetFunc    - get a value</span><br><span class="line">set &quot;var1=DosTips&quot;</span><br><span class="line">goto:eof</span><br></pre></td></tr></table></figure>

<p>脚本输出如下：</p>
<p>var1 before: some hopefully not important string<br>var1 after : DosTips<br>  2、通过引用返回值，调用者通过传递一个变量给函数来存储返回值</p>
<p>Usage:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> call:myGetFunc var1</span><br><span class="line">echo.var1 after : %var1%</span><br></pre></td></tr></table></figure>

<p>Script:</p>
<p> :myGetFunc    - passing a variable by reference<br>set “%~1&#x3D;DosTips”<br>goto:eof<br>脚本输出如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var1 after : DosTips</span><br></pre></td></tr></table></figure>
<p>完整脚本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> @echo off</span><br><span class="line">set &quot;var1=CmdTips&quot;</span><br><span class="line">echo.var1 before: %var1%</span><br><span class="line">call:myGetFunc var1</span><br><span class="line">echo.var1 after : %var1%</span><br><span class="line">echo.&amp;pause&amp;goto:eof</span><br><span class="line"></span><br><span class="line">::--------------------------------------------------------</span><br><span class="line">::-- Function section starts below here</span><br><span class="line">::--------------------------------------------------------</span><br><span class="line">:myGetFunc    - passing a variable by reference</span><br><span class="line">set &quot;%~1=DosTips&quot;</span><br><span class="line">goto:eof</span><br></pre></td></tr></table></figure>
<p>五、函数的局部变量</p>
<p>怎么保证局部变量和全局变量不冲突，SETLOCAL命令能让处理器当做是局部变量，用ENDLOCAL解除局部变量。</p>
<p>ENDLOCAL 会被自动调用，当批处理执行到文件末尾的时候，即GOTO:EOF。SETLOCAL可以很好的保护函数内与外面的变量不会冲突。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> @echo off</span><br><span class="line">set &quot;aStr=Expect no changed, even if used in function&quot;</span><br><span class="line">set &quot;var1=No change for this one.  Now what?&quot;</span><br><span class="line">echo.aStr before: %aStr%</span><br><span class="line">echo.var1 before: %var1%</span><br><span class="line">call:myGetFunc var1</span><br><span class="line">echo.aStr after : %aStr%</span><br><span class="line">echo.var1 after : %var1%</span><br><span class="line">echo.&amp;pause&amp;goto:eof</span><br><span class="line">::--------------------------------------------------------</span><br><span class="line">::-- Function section starts below here</span><br><span class="line">::--------------------------------------------------------</span><br><span class="line">:myGetFunc    - passing a variable by reference</span><br><span class="line">SETLOCAL</span><br><span class="line">set &quot;aStr=DosTips&quot;</span><br><span class="line">set &quot;%~1=%aStr%&quot;</span><br><span class="line">ENDLOCAL</span><br><span class="line">goto:eof</span><br></pre></td></tr></table></figure>

<p>脚本输出：</p>
<p>aStr before: Expect no changed, even if used in function<br>var1 before: No change for this one.  Now what?<br>aStr after : Expect no changed, even if used in function<br>var1 after : No change for this one.  Now what?</p>
<p>   返回局部变量</p>
<pre><code>  ----怎么跳过ENDLOCAL的屏障，返回局部变量值？
</code></pre>
<p>   采用”变量扩充“，在SETLOCAL与ENDLOCAL之间的全局变量的值会备份，当退出ENDLOCAL，该值将恢复。让命令处理器来执行ENDLOCAL 和SET命令。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"> @echo off</span><br><span class="line">set &quot;aStr=Expect no changed, even if used in function&quot;</span><br><span class="line">set &quot;var1=Expect changed&quot;</span><br><span class="line">echo.aStr before: %aStr%</span><br><span class="line">echo.var1 before: %var1%</span><br><span class="line">call:myGetFunc var1</span><br><span class="line">echo.aStr after : %aStr%</span><br><span class="line">echo.var1 after : %var1%</span><br><span class="line">echo.&amp;pause&amp;goto:eof</span><br><span class="line">::--------------------------------------------------------</span><br><span class="line">::-- Function section starts below here</span><br><span class="line">::--------------------------------------------------------</span><br><span class="line">:myGetFunc    - passing a variable by reference</span><br><span class="line">SETLOCAL</span><br><span class="line">set &quot;aStr=DosTips&quot;</span><br><span class="line">( ENDLOCAL</span><br><span class="line">    set &quot;%~1=%aStr%&quot;</span><br><span class="line">)</span><br><span class="line">goto:eof</span><br><span class="line">:myGetFunc2    - passing a variable by reference</span><br><span class="line">SETLOCAL</span><br><span class="line">set &quot;aStr=DosTips&quot;</span><br><span class="line">ENDLOCAL&amp;set &quot;%~1=%aStr%&quot;       &amp;rem THIS ALSO WORKS FINE</span><br><span class="line">goto:eof</span><br></pre></td></tr></table></figure>


<p>脚本输出：</p>
<p>aStr before: Expect no changed, even if used in function<br>var1 before: Expect changed<br>aStr after : Expect no changed, even if used in function<br>var1 after : DosTips<br>六、编写递归函数</p>
<pre><code> 让函数局部变量的变换对调用者是可见的，循环调用函数，让变量可重用。下面编写一个函数计算Fibonacci数列。
</code></pre>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"> @echo off</span><br><span class="line">set &quot;fst=0&quot;</span><br><span class="line">set &quot;fib=1&quot;</span><br><span class="line">set &quot;limit=1000000000&quot;</span><br><span class="line">call:myFibo fib,%fst%,%limit%</span><br><span class="line">echo.The next Fibonacci number greater or equal %limit% is %fib%.</span><br><span class="line">echo.&amp;pause&amp;goto:eof</span><br><span class="line"></span><br><span class="line">::--------------------------------------------------------</span><br><span class="line">::-- Function section starts below here</span><br><span class="line">::--------------------------------------------------------</span><br><span class="line">:myFibo  -- calculate recursively the next Fibonacci number greater or equal to a limit</span><br><span class="line">::       -- %~1: return variable reference and current Fibonacci number</span><br><span class="line">::       -- %~2: previous value</span><br><span class="line">::       -- %~3: limit</span><br><span class="line">SETLOCAL</span><br><span class="line">set /a &quot;Number1=%~1&quot;</span><br><span class="line">set /a &quot;Number2=%~2&quot;</span><br><span class="line">set /a &quot;Limit=%~3&quot;</span><br><span class="line">set /a &quot;NumberN=Number1 + Number2&quot;</span><br><span class="line">if /i %NumberN% LSS %Limit% call:myFibo NumberN,%Number1%,%Limit%</span><br><span class="line">(ENDLOCAL</span><br><span class="line">    IF &quot;%~1&quot; NEQ &quot;&quot; SET &quot;%~1=%NumberN%&quot;</span><br><span class="line">)</span><br><span class="line">goto:eof</span><br></pre></td></tr></table></figure>

<p>七、总结，定义一个标准的dos batch script function</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> :myFunctionName    -- function description here</span><br><span class="line">::                 -- %~1: argument description here</span><br><span class="line">SETLOCAL</span><br><span class="line">REM.--function body here</span><br><span class="line">set LocalVar1=...</span><br><span class="line">set LocalVar2=...</span><br><span class="line">(ENDLOCAL &amp; REM -- RETURN VALUES</span><br><span class="line">    IF &quot;%~1&quot; NEQ &quot;&quot; SET %~1=%LocalVar1%</span><br><span class="line">    IF &quot;%~2&quot; NEQ &quot;&quot; SET %~2=%LocalVar2%</span><br><span class="line">)</span><br><span class="line">GOTO:EOF</span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-20220805-powershell判断路径是否存在"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/08/05/20220805-powershell%E5%88%A4%E6%96%AD%E8%B7%AF%E5%BE%84%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8/"
    >20220805-powershell判断路径是否存在</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/08/05/20220805-powershell%E5%88%A4%E6%96%AD%E8%B7%AF%E5%BE%84%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8/" class="article-date">
  <time datetime="2022-08-05T03:55:25.000Z" itemprop="datePublished">2022-08-05</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$CONFIG_PATH</span>=<span class="string">&quot;D:\powershell\2&quot;</span></span><br><span class="line"><span class="variable">$TRUE_FALSE</span>=(<span class="built_in">Test-Path</span> <span class="variable">$CONFIG_PATH</span>)</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$TRUE_FALSE</span> <span class="operator">-eq</span> <span class="string">&quot;True&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">remove-Item</span> <span class="literal">-Recurse</span> <span class="literal">-Force</span> <span class="variable">$CONFIG_PATH</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-20220802-windows下tree的用法"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2022/08/02/20220802-windows%E4%B8%8Btree%E7%9A%84%E7%94%A8%E6%B3%95/"
    >20220802-windows下tree的用法</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2022/08/02/20220802-windows%E4%B8%8Btree%E7%9A%84%E7%94%A8%E6%B3%95/" class="article-date">
  <time datetime="2022-08-02T04:57:17.000Z" itemprop="datePublished">2022-08-02</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="Window平台下tree-命令使用"><a href="#Window平台下tree-命令使用" class="headerlink" title="Window平台下tree 命令使用"></a><a target="_blank" rel="noopener" href="https://www.cnblogs.com/ricolee/p/cmd-tree.html">Window平台下tree 命令使用</a></h1><p>WIndow 平台要想打印目录树，可以用cmd工具或者power shell 的<code>tree</code>命令实现</p>
<p>tree 命令格式和参数：</p>
<p>TREE [drive:][path] [&#x2F;F] [&#x2F;A]</p>
<ul>
<li>&#x2F;F 显示每个文件夹中文件的名称。（带扩展名）</li>
<li>&#x2F;A 使用 ASCII 字符，而不使用扩展字符。(如果要显示中文，例如 tree &#x2F;f &#x2F;A &gt;tree.txt)</li>
</ul>
<p>比如：</p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Copy</span> <span class="built_in">tree</span> /f &gt;<span class="built_in">tree</span>.txt</span><br></pre></td></tr></table></figure>

<p>导出当前目录的文件夹&#x2F;文件的目录树到tree.txt文件中。</p>
<blockquote>
<p><strong>Tip：</strong></p>
<ol>
<li>要是目录很深文件很多生成的树大了去!，比如我在D盘根目录使用49MB的tree.txt；</li>
<li>没找到其它参数可以只打印一级或者二级目录类似的参数；</li>
</ol>
</blockquote>
<p>又或者用git bash 工具 使用<code>tree</code>命令，比如：</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Copy$ tree -L <span class="number">1</span></span><br><span class="line">.</span><br><span class="line">|<span class="comment">-- LICENSE        </span></span><br><span class="line">|<span class="comment">-- README.es.md   </span></span><br><span class="line">|<span class="comment">-- README.ja.md   </span></span><br><span class="line">|<span class="comment">-- README.md      </span></span><br><span class="line">|<span class="comment">-- README.zh-CN.md</span></span><br><span class="line">|<span class="comment">-- babel.config.js</span></span><br><span class="line">|<span class="comment">-- build</span></span><br><span class="line">|<span class="comment">-- dist</span></span><br><span class="line">|<span class="comment">-- jest.config.js</span></span><br><span class="line">|<span class="comment">-- list.txt</span></span><br><span class="line">|<span class="comment">-- mock</span></span><br><span class="line">|<span class="comment">-- node_modules</span></span><br><span class="line">|<span class="comment">-- package-lock.json</span></span><br><span class="line">|<span class="comment">-- package.json</span></span><br><span class="line">|<span class="comment">-- plop-templates</span></span><br><span class="line">|<span class="comment">-- plopfile.js</span></span><br><span class="line">|<span class="comment">-- postcss.config.js</span></span><br><span class="line">|<span class="comment">-- public</span></span><br><span class="line">|<span class="comment">-- src</span></span><br><span class="line">|<span class="comment">-- tests</span></span><br><span class="line">|<span class="comment">-- vue-elment-admin.md</span></span><br><span class="line">`<span class="comment">-- vue.config.js</span></span><br></pre></td></tr></table></figure>

<p>比cmd和power shell 好用，前提是需要安装Tree for Windows工具：</p>
<ol>
<li>打开进入 <a target="_blank" rel="noopener" href="http://gnuwin32.sourceforge.net/packages/tree.htm">Tree for Windows</a> 页面，选择下载 Binaries zip 文件。</li>
<li>解压压缩包，找到压缩包内的 bin 目录，将 bin 目录下的 tree.exe 复制</li>
<li>找到 <code>C:\\Program Files\Git\usr\bin</code> 目录，将 tree.exe 粘贴到该目录下，安装即完成</li>
</ol>
<p>tree命令行参数：</p>
<ul>
<li>-a 显示所有文件和目录。</li>
<li>-A 使用ASNI绘图字符显示树状图而非以ASCII字符组合。</li>
<li>-C 在文件和目录清单加上色彩，便于区分各种类型。</li>
<li>-d 显示目录名称而非内容。</li>
<li>-D 列出文件或目录的更改时间。</li>
<li>-f 在每个文件或目录之前，显示完整的相对路径名称。</li>
<li>-F 在执行文件，目录，Socket，符号连接，管道名称名称，各自加上”*”,”&#x2F;“,”&#x3D;”,”@”,”|“号。</li>
<li>-g 列出文件或目录的所属群组名称，没有对应的名称时，则显示群组识别码。</li>
<li>-i 不以阶梯状列出文件或目录名称。</li>
<li>-I 不显示符合范本样式的文件或目录名称。</li>
<li>-l 如遇到性质为符号连接的目录，直接列出该连接所指向的原始目录。</li>
<li>-n 不在文件和目录清单加上色彩。</li>
<li>-N 直接列出文件和目录名称，包括控制字符。</li>
<li>-p 列出权限标示。</li>
<li>-P 只显示符合范本样式的文件或目录名称。</li>
<li>-q 用”?”号取代控制字符，列出文件和目录名称。</li>
<li>-s 列出文件或目录大小。</li>
<li>-t 用文件和目录的更改时间排序。</li>
<li>-u 列出文件或目录的拥有者名称，没有对应的名称时，则显示用户识别码。</li>
<li>-x 将范围局限在现行的文件系统中，若指定目录下的某些子目录，其存放于另一个文件系统上，则将该子目录予以排除在寻找范围外。</li>
</ul>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考#"></a>参考<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ricolee/p/cmd-tree.html#3188521218">#</a></h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/32ba82d84680">Window 平台下添加 tree 命令</a></li>
</ul>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

   
    
</article>

    
  </article>
  

  
  <nav class="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/12/">上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="page-number" href="/page/12/">12</a><span class="page-number current">13</span><a class="page-number" href="/page/14/">14</a><a class="page-number" href="/page/15/">15</a><span class="space">&hellip;</span><a class="page-number" href="/page/20/">20</a><a class="extend next" rel="next" href="/page/14/">下一页</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2015-2023
        <i class="ri-heart-fill heart_icon"></i> TeX_baitu
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>访问人数:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>浏览次数:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="TeX_baitu blog"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags/%E6%97%85%E8%A1%8C/">旅行</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" target="_blank" rel="noopener" href="http://shenyu-vip.lofter.com">摄影</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/friends">友链</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/2019/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="搜索">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    

  </div>
</body>

</html>